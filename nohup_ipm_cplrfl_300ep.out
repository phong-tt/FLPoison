nohup: ignoring input
Warning: Overriding benchmark with False
Warning: Overriding epochs with 300
Warning: Overriding distribution with non-iid
Warning: Overriding dirichlet_alpha with 0.1
Using device: cuda:1
Traceback (most recent call last):
  File "/home/lyvt/FLPoison/main.py", line 148, in <module>
    main(args, cli_args)
  File "/home/lyvt/FLPoison/main.py", line 143, in main
    fl_run(args)
  File "/home/lyvt/FLPoison/main.py", line 65, in fl_run
    the_server.aggregation()
  File "/home/lyvt/FLPoison/fl/server.py", line 52, in aggregation
    self.aggregated_update = self.aggregator.aggregate(
  File "/home/lyvt/FLPoison/aggregators/cplrfl.py", line 439, in aggregate
    class_similarities = self._calculate_classwise_similarities(
  File "/home/lyvt/FLPoison/aggregators/cplrfl.py", line 340, in _calculate_classwise_similarities
    sim = self._compute_similarity(plr_i, plr_j, self.similarity_metric)
  File "/home/lyvt/FLPoison/aggregators/cplrfl.py", line 200, in _compute_similarity
    return self._compute_mmd(plr_a, plr_b)
  File "/home/lyvt/FLPoison/aggregators/cplrfl.py", line 233, in _compute_mmd
    K = pairwise_kernels(XY, metric=self.mmd_kernel, **kernel_kwargs)
  File "/home/lyvt/.conda/envs/torchenv/lib/python3.10/site-packages/sklearn/utils/_param_validation.py", line 216, in wrapper
    return func(*args, **kwargs)
  File "/home/lyvt/.conda/envs/torchenv/lib/python3.10/site-packages/sklearn/metrics/pairwise.py", line 2673, in pairwise_kernels
    return _parallel_pairwise(X, Y, func, n_jobs, **kwds)
  File "/home/lyvt/.conda/envs/torchenv/lib/python3.10/site-packages/sklearn/metrics/pairwise.py", line 1973, in _parallel_pairwise
    return func(X, Y, **kwds)
  File "/home/lyvt/.conda/envs/torchenv/lib/python3.10/site-packages/sklearn/utils/_param_validation.py", line 189, in wrapper
    return func(*args, **kwargs)
  File "/home/lyvt/.conda/envs/torchenv/lib/python3.10/site-packages/sklearn/metrics/pairwise.py", line 1615, in rbf_kernel
    X, Y = check_pairwise_arrays(X, Y)
  File "/home/lyvt/.conda/envs/torchenv/lib/python3.10/site-packages/sklearn/metrics/pairwise.py", line 190, in check_pairwise_arrays
    X = Y = check_array(
  File "/home/lyvt/.conda/envs/torchenv/lib/python3.10/site-packages/sklearn/utils/validation.py", line 1107, in check_array
    _assert_all_finite(
  File "/home/lyvt/.conda/envs/torchenv/lib/python3.10/site-packages/sklearn/utils/validation.py", line 120, in _assert_all_finite
    _assert_all_finite_element_wise(
  File "/home/lyvt/.conda/envs/torchenv/lib/python3.10/site-packages/sklearn/utils/validation.py", line 169, in _assert_all_finite_element_wise
    raise ValueError(msg_err)
ValueError: Input contains NaN.
