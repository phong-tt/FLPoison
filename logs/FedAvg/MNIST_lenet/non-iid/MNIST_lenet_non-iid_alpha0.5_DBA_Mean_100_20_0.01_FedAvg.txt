seed: 4, epochs: 100, algorithm: FedAvg, optimizer: SGD, momentum: 0.9, weight_decay: 0.0005, num_clients: 20, batch_size: 4096, learning_rate: 0.01, local_epochs: 2, model: lenet, dataset: MNIST, distribution: non-iid, im_iid_gamma: 0.01, tail_cls_from: 4, dirichlet_alpha: 0.5, cache_partition: False, gpu_idx: [1], num_workers: 16, record_time: False, num_adv: 4, attack: DBA, defense: Mean, attack_params: {'attack_model': 'all2one', 'scaling_factor': 100, 'trigger_factor': [8, 2, 0], 'poisoning_ratio': 0.32, 'source_label': 2, 'target_label': 7, 'attack_strategy': 'continuous'}, defense_params: None, benchmark: False, num_training_sample: 60000, num_channels: 1, num_classes: 10, mean: (0.1307,), std: (0.3081,), device: cuda:1, output: ./logs/FedAvg/MNIST_lenet/non-iid/MNIST_lenet_non-iid_alpha0.5_DBA_Mean_100_20_0.01_FedAvg.txt

Started on Mon Jan 26 15:00:42 2026
Generating new indices
Doing non-iid partition
dirichlet alpha: 0.5
non-iid partition finished
Data partitioned
Clients and server are initialized
Starting Training...
Epoch 0  		Train Acc: 0.0795	Train loss: 0.0012	Test Acc: 0.1033	Test loss: 0.0007	ASR: 0.0000	ASR loss: 0.0007
Epoch 1  		Train Acc: 0.0790	Train loss: 0.0012	Test Acc: 0.1033	Test loss: 0.0007	ASR: 0.0000	ASR loss: 0.0007
Epoch 2  		Train Acc: 0.0805	Train loss: 0.0012	Test Acc: 0.1039	Test loss: 0.0007	ASR: 0.0000	ASR loss: 0.0007
Epoch 3  		Train Acc: 0.0852	Train loss: 0.0012	Test Acc: 0.1040	Test loss: 0.0007	ASR: 0.0000	ASR loss: 0.0007
Epoch 4  		Train Acc: 0.1135	Train loss: 0.0012	Test Acc: 0.1097	Test loss: 0.0007	ASR: 0.0098	ASR loss: 0.0007
Epoch 5  		Train Acc: 0.1496	Train loss: 0.0012	Test Acc: 0.1712	Test loss: 0.0007	ASR: 0.2614	ASR loss: 0.0007
Epoch 6  		Train Acc: 0.2095	Train loss: 0.0012	Test Acc: 0.1374	Test loss: 0.0007	ASR: 0.8150	ASR loss: 0.0007
Epoch 7  		Train Acc: 0.2226	Train loss: 0.0012	Test Acc: 0.1109	Test loss: 0.0007	ASR: 0.9826	ASR loss: 0.0007
Epoch 8  		Train Acc: 0.2158	Train loss: 0.0012	Test Acc: 0.1030	Test loss: 0.0007	ASR: 0.9996	ASR loss: 0.0007
Epoch 9  		Train Acc: 0.2155	Train loss: 0.0012	Test Acc: 0.1032	Test loss: 0.0007	ASR: 0.9996	ASR loss: 0.0006
Epoch 10 		Train Acc: 0.2197	Train loss: 0.0012	Test Acc: 0.1049	Test loss: 0.0007	ASR: 0.9979	ASR loss: 0.0006
Epoch 11 		Train Acc: 0.2272	Train loss: 0.0012	Test Acc: 0.1117	Test loss: 0.0007	ASR: 0.9900	ASR loss: 0.0006
Epoch 12 		Train Acc: 0.2390	Train loss: 0.0011	Test Acc: 0.1225	Test loss: 0.0007	ASR: 0.9774	ASR loss: 0.0006
Epoch 13 		Train Acc: 0.2469	Train loss: 0.0011	Test Acc: 0.1342	Test loss: 0.0007	ASR: 0.9647	ASR loss: 0.0006
Epoch 14 		Train Acc: 0.2601	Train loss: 0.0011	Test Acc: 0.1459	Test loss: 0.0007	ASR: 0.9512	ASR loss: 0.0006
Epoch 15 		Train Acc: 0.2698	Train loss: 0.0011	Test Acc: 0.1563	Test loss: 0.0007	ASR: 0.9386	ASR loss: 0.0006
Epoch 16 		Train Acc: 0.2798	Train loss: 0.0011	Test Acc: 0.1639	Test loss: 0.0007	ASR: 0.9293	ASR loss: 0.0006
Epoch 17 		Train Acc: 0.2930	Train loss: 0.0011	Test Acc: 0.1701	Test loss: 0.0007	ASR: 0.9189	ASR loss: 0.0006
Epoch 18 		Train Acc: 0.3084	Train loss: 0.0011	Test Acc: 0.1753	Test loss: 0.0007	ASR: 0.9081	ASR loss: 0.0005
Epoch 19 		Train Acc: 0.3283	Train loss: 0.0010	Test Acc: 0.1815	Test loss: 0.0006	ASR: 0.8923	ASR loss: 0.0005
Epoch 20 		Train Acc: 0.3421	Train loss: 0.0010	Test Acc: 0.1909	Test loss: 0.0006	ASR: 0.8593	ASR loss: 0.0005
Epoch 21 		Train Acc: 0.3577	Train loss: 0.0010	Test Acc: 0.2434	Test loss: 0.0006	ASR: 0.7441	ASR loss: 0.0005
Epoch 22 		Train Acc: 0.3905	Train loss: 0.0009	Test Acc: 0.4212	Test loss: 0.0006	ASR: 0.5191	ASR loss: 0.0006
Epoch 23 		Train Acc: 0.4827	Train loss: 0.0008	Test Acc: 0.5309	Test loss: 0.0005	ASR: 0.3551	ASR loss: 0.0006
Epoch 24 		Train Acc: 0.5412	Train loss: 0.0008	Test Acc: 0.5706	Test loss: 0.0005	ASR: 0.3066	ASR loss: 0.0006
Epoch 25 		Train Acc: 0.5712	Train loss: 0.0007	Test Acc: 0.6505	Test loss: 0.0004	ASR: 0.2357	ASR loss: 0.0007
Epoch 26 		Train Acc: 0.6207	Train loss: 0.0007	Test Acc: 0.7018	Test loss: 0.0004	ASR: 0.1863	ASR loss: 0.0008
Epoch 27 		Train Acc: 0.6556	Train loss: 0.0006	Test Acc: 0.7246	Test loss: 0.0003	ASR: 0.1564	ASR loss: 0.0009
Epoch 28 		Train Acc: 0.6857	Train loss: 0.0006	Test Acc: 0.7179	Test loss: 0.0003	ASR: 0.1816	ASR loss: 0.0008
Epoch 29 		Train Acc: 0.6791	Train loss: 0.0006	Test Acc: 0.7623	Test loss: 0.0003	ASR: 0.1253	ASR loss: 0.0010
Epoch 30 		Train Acc: 0.7129	Train loss: 0.0005	Test Acc: 0.7681	Test loss: 0.0002	ASR: 0.1340	ASR loss: 0.0010
Epoch 31 		Train Acc: 0.7052	Train loss: 0.0005	Test Acc: 0.7746	Test loss: 0.0002	ASR: 0.1429	ASR loss: 0.0009
Epoch 32 		Train Acc: 0.7307	Train loss: 0.0004	Test Acc: 0.7885	Test loss: 0.0002	ASR: 0.1320	ASR loss: 0.0010
Epoch 33 		Train Acc: 0.7378	Train loss: 0.0004	Test Acc: 0.7940	Test loss: 0.0002	ASR: 0.1361	ASR loss: 0.0009
Epoch 34 		Train Acc: 0.7564	Train loss: 0.0004	Test Acc: 0.8046	Test loss: 0.0002	ASR: 0.1315	ASR loss: 0.0010
Epoch 35 		Train Acc: 0.7641	Train loss: 0.0004	Test Acc: 0.8174	Test loss: 0.0002	ASR: 0.1286	ASR loss: 0.0010
Epoch 36 		Train Acc: 0.7740	Train loss: 0.0004	Test Acc: 0.8280	Test loss: 0.0002	ASR: 0.1272	ASR loss: 0.0010
Epoch 37 		Train Acc: 0.7794	Train loss: 0.0003	Test Acc: 0.8347	Test loss: 0.0002	ASR: 0.1273	ASR loss: 0.0010
Epoch 38 		Train Acc: 0.7882	Train loss: 0.0003	Test Acc: 0.8426	Test loss: 0.0002	ASR: 0.1237	ASR loss: 0.0011
Epoch 39 		Train Acc: 0.7945	Train loss: 0.0003	Test Acc: 0.8481	Test loss: 0.0002	ASR: 0.1218	ASR loss: 0.0011
Epoch 40 		Train Acc: 0.7983	Train loss: 0.0003	Test Acc: 0.8535	Test loss: 0.0001	ASR: 0.1212	ASR loss: 0.0010
Epoch 41 		Train Acc: 0.8032	Train loss: 0.0003	Test Acc: 0.8586	Test loss: 0.0001	ASR: 0.1207	ASR loss: 0.0010
Epoch 42 		Train Acc: 0.8083	Train loss: 0.0003	Test Acc: 0.8642	Test loss: 0.0001	ASR: 0.1200	ASR loss: 0.0010
Epoch 43 		Train Acc: 0.8137	Train loss: 0.0003	Test Acc: 0.8687	Test loss: 0.0001	ASR: 0.1187	ASR loss: 0.0010
Epoch 44 		Train Acc: 0.8185	Train loss: 0.0003	Test Acc: 0.8730	Test loss: 0.0001	ASR: 0.1175	ASR loss: 0.0010
Epoch 45 		Train Acc: 0.8216	Train loss: 0.0003	Test Acc: 0.8763	Test loss: 0.0001	ASR: 0.1171	ASR loss: 0.0010
Epoch 46 		Train Acc: 0.8230	Train loss: 0.0003	Test Acc: 0.8798	Test loss: 0.0001	ASR: 0.1172	ASR loss: 0.0010
Epoch 47 		Train Acc: 0.8267	Train loss: 0.0003	Test Acc: 0.8828	Test loss: 0.0001	ASR: 0.1170	ASR loss: 0.0010
Epoch 48 		Train Acc: 0.8294	Train loss: 0.0003	Test Acc: 0.8854	Test loss: 0.0001	ASR: 0.1166	ASR loss: 0.0010
Epoch 49 		Train Acc: 0.8325	Train loss: 0.0003	Test Acc: 0.8877	Test loss: 0.0001	ASR: 0.1161	ASR loss: 0.0010
Epoch 50 		Train Acc: 0.8349	Train loss: 0.0003	Test Acc: 0.8900	Test loss: 0.0001	ASR: 0.1152	ASR loss: 0.0010
Epoch 51 		Train Acc: 0.8367	Train loss: 0.0002	Test Acc: 0.8923	Test loss: 0.0001	ASR: 0.1147	ASR loss: 0.0010
Epoch 52 		Train Acc: 0.8387	Train loss: 0.0002	Test Acc: 0.8951	Test loss: 0.0001	ASR: 0.1140	ASR loss: 0.0010
Epoch 53 		Train Acc: 0.8421	Train loss: 0.0002	Test Acc: 0.8971	Test loss: 0.0001	ASR: 0.1126	ASR loss: 0.0010
Epoch 54 		Train Acc: 0.8423	Train loss: 0.0002	Test Acc: 0.8983	Test loss: 0.0001	ASR: 0.1124	ASR loss: 0.0010
Epoch 55 		Train Acc: 0.8450	Train loss: 0.0002	Test Acc: 0.8995	Test loss: 0.0001	ASR: 0.1118	ASR loss: 0.0010
Epoch 56 		Train Acc: 0.8457	Train loss: 0.0002	Test Acc: 0.9029	Test loss: 0.0001	ASR: 0.1114	ASR loss: 0.0010
Epoch 57 		Train Acc: 0.8469	Train loss: 0.0002	Test Acc: 0.9052	Test loss: 0.0001	ASR: 0.1116	ASR loss: 0.0010
Epoch 58 		Train Acc: 0.8489	Train loss: 0.0002	Test Acc: 0.9078	Test loss: 0.0001	ASR: 0.1115	ASR loss: 0.0010
Epoch 59 		Train Acc: 0.8506	Train loss: 0.0002	Test Acc: 0.9091	Test loss: 0.0001	ASR: 0.1111	ASR loss: 0.0010
Epoch 60 		Train Acc: 0.8541	Train loss: 0.0002	Test Acc: 0.9104	Test loss: 0.0001	ASR: 0.1104	ASR loss: 0.0010
Epoch 61 		Train Acc: 0.8530	Train loss: 0.0002	Test Acc: 0.9126	Test loss: 0.0001	ASR: 0.1102	ASR loss: 0.0010
Epoch 62 		Train Acc: 0.8553	Train loss: 0.0002	Test Acc: 0.9144	Test loss: 0.0001	ASR: 0.1107	ASR loss: 0.0010
Epoch 63 		Train Acc: 0.8558	Train loss: 0.0002	Test Acc: 0.9157	Test loss: 0.0001	ASR: 0.1109	ASR loss: 0.0010
Epoch 64 		Train Acc: 0.8574	Train loss: 0.0002	Test Acc: 0.9163	Test loss: 0.0001	ASR: 0.1103	ASR loss: 0.0010
Epoch 65 		Train Acc: 0.8593	Train loss: 0.0002	Test Acc: 0.9174	Test loss: 0.0001	ASR: 0.1103	ASR loss: 0.0010
Epoch 66 		Train Acc: 0.8611	Train loss: 0.0002	Test Acc: 0.9185	Test loss: 0.0001	ASR: 0.1108	ASR loss: 0.0010
Epoch 67 		Train Acc: 0.8616	Train loss: 0.0002	Test Acc: 0.9194	Test loss: 0.0001	ASR: 0.1108	ASR loss: 0.0010
Epoch 68 		Train Acc: 0.8632	Train loss: 0.0002	Test Acc: 0.9197	Test loss: 0.0001	ASR: 0.1108	ASR loss: 0.0010
Epoch 69 		Train Acc: 0.8630	Train loss: 0.0002	Test Acc: 0.9212	Test loss: 0.0001	ASR: 0.1104	ASR loss: 0.0010
Epoch 70 		Train Acc: 0.8650	Train loss: 0.0002	Test Acc: 0.9224	Test loss: 0.0001	ASR: 0.1104	ASR loss: 0.0010
Epoch 71 		Train Acc: 0.8655	Train loss: 0.0002	Test Acc: 0.9233	Test loss: 0.0001	ASR: 0.1106	ASR loss: 0.0010
Epoch 72 		Train Acc: 0.8663	Train loss: 0.0002	Test Acc: 0.9248	Test loss: 0.0001	ASR: 0.1108	ASR loss: 0.0010
Epoch 73 		Train Acc: 0.8683	Train loss: 0.0002	Test Acc: 0.9258	Test loss: 0.0001	ASR: 0.1105	ASR loss: 0.0010
Epoch 74 		Train Acc: 0.8695	Train loss: 0.0002	Test Acc: 0.9274	Test loss: 0.0001	ASR: 0.1103	ASR loss: 0.0010
Epoch 75 		Train Acc: 0.8697	Train loss: 0.0002	Test Acc: 0.9283	Test loss: 0.0001	ASR: 0.1102	ASR loss: 0.0010
Epoch 76 		Train Acc: 0.8707	Train loss: 0.0002	Test Acc: 0.9291	Test loss: 0.0001	ASR: 0.1101	ASR loss: 0.0010
Epoch 77 		Train Acc: 0.8716	Train loss: 0.0002	Test Acc: 0.9306	Test loss: 0.0001	ASR: 0.1099	ASR loss: 0.0010
Epoch 78 		Train Acc: 0.8723	Train loss: 0.0002	Test Acc: 0.9323	Test loss: 0.0001	ASR: 0.1096	ASR loss: 0.0010
Epoch 79 		Train Acc: 0.8729	Train loss: 0.0002	Test Acc: 0.9337	Test loss: 0.0001	ASR: 0.1093	ASR loss: 0.0010
Epoch 80 		Train Acc: 0.8750	Train loss: 0.0002	Test Acc: 0.9344	Test loss: 0.0001	ASR: 0.1101	ASR loss: 0.0010
Epoch 81 		Train Acc: 0.8747	Train loss: 0.0002	Test Acc: 0.9353	Test loss: 0.0001	ASR: 0.1105	ASR loss: 0.0010
Epoch 82 		Train Acc: 0.8768	Train loss: 0.0002	Test Acc: 0.9367	Test loss: 0.0001	ASR: 0.1099	ASR loss: 0.0010
Epoch 83 		Train Acc: 0.8754	Train loss: 0.0002	Test Acc: 0.9375	Test loss: 0.0001	ASR: 0.1097	ASR loss: 0.0010
Epoch 84 		Train Acc: 0.8757	Train loss: 0.0002	Test Acc: 0.9379	Test loss: 0.0001	ASR: 0.1095	ASR loss: 0.0010
Epoch 85 		Train Acc: 0.8782	Train loss: 0.0002	Test Acc: 0.9388	Test loss: 0.0001	ASR: 0.1092	ASR loss: 0.0010
Epoch 86 		Train Acc: 0.8778	Train loss: 0.0002	Test Acc: 0.9404	Test loss: 0.0001	ASR: 0.1090	ASR loss: 0.0010
Epoch 87 		Train Acc: 0.8792	Train loss: 0.0002	Test Acc: 0.9411	Test loss: 0.0001	ASR: 0.1089	ASR loss: 0.0010
Epoch 88 		Train Acc: 0.8798	Train loss: 0.0002	Test Acc: 0.9414	Test loss: 0.0001	ASR: 0.1091	ASR loss: 0.0010
Epoch 89 		Train Acc: 0.8795	Train loss: 0.0002	Test Acc: 0.9421	Test loss: 0.0001	ASR: 0.1092	ASR loss: 0.0010
Epoch 90 		Train Acc: 0.8804	Train loss: 0.0002	Test Acc: 0.9425	Test loss: 0.0001	ASR: 0.1093	ASR loss: 0.0010
Epoch 91 		Train Acc: 0.8815	Train loss: 0.0002	Test Acc: 0.9432	Test loss: 0.0001	ASR: 0.1091	ASR loss: 0.0010
Epoch 92 		Train Acc: 0.8839	Train loss: 0.0002	Test Acc: 0.9439	Test loss: 0.0001	ASR: 0.1090	ASR loss: 0.0010
Epoch 93 		Train Acc: 0.8837	Train loss: 0.0002	Test Acc: 0.9448	Test loss: 0.0001	ASR: 0.1087	ASR loss: 0.0010
Epoch 94 		Train Acc: 0.8829	Train loss: 0.0002	Test Acc: 0.9459	Test loss: 0.0001	ASR: 0.1084	ASR loss: 0.0010
Epoch 95 		Train Acc: 0.8833	Train loss: 0.0002	Test Acc: 0.9469	Test loss: 0.0001	ASR: 0.1085	ASR loss: 0.0010
Epoch 96 		Train Acc: 0.8848	Train loss: 0.0002	Test Acc: 0.9473	Test loss: 0.0001	ASR: 0.1086	ASR loss: 0.0010
Epoch 97 		Train Acc: 0.8833	Train loss: 0.0002	Test Acc: 0.9473	Test loss: 0.0001	ASR: 0.1086	ASR loss: 0.0010
Epoch 98 		Train Acc: 0.8856	Train loss: 0.0002	Test Acc: 0.9477	Test loss: 0.0001	ASR: 0.1085	ASR loss: 0.0010
Epoch 99 		Train Acc: 0.8843	Train loss: 0.0002	Test Acc: 0.9484	Test loss: 0.0001	ASR: 0.1082	ASR loss: 0.0010
Training finished on Mon Jan 26 16:03:22 2026 using 62 minutes and 40 seconds in total.
