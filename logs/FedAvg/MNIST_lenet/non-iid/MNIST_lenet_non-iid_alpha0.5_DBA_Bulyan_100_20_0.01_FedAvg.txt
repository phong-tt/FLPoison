seed: 4, epochs: 100, algorithm: FedAvg, optimizer: SGD, momentum: 0.9, weight_decay: 0.0005, num_clients: 20, batch_size: 4096, learning_rate: 0.01, local_epochs: 2, model: lenet, dataset: MNIST, distribution: non-iid, im_iid_gamma: 0.01, tail_cls_from: 4, dirichlet_alpha: 0.5, cache_partition: False, gpu_idx: [1], num_workers: 16, record_time: False, num_adv: 4, attack: DBA, defense: Bulyan, attack_params: {'attack_model': 'all2one', 'scaling_factor': 100, 'trigger_factor': [8, 2, 0], 'poisoning_ratio': 0.32, 'source_label': 2, 'target_label': 7, 'attack_strategy': 'continuous'}, defense_params: {'aux_data_num': 100, 'selected_class': 1, 'tau': 1.0, 'mmd_kernel': 'rbf', 'mmd_gamma': None}, benchmark: False, num_training_sample: 60000, num_channels: 1, num_classes: 10, mean: (0.1307,), std: (0.3081,), device: cuda:1, output: ./logs/FedAvg/MNIST_lenet/non-iid/MNIST_lenet_non-iid_alpha0.5_DBA_Bulyan_100_20_0.01_FedAvg.txt

Started on Mon Jan 26 15:00:42 2026
Generating new indices
Doing non-iid partition
dirichlet alpha: 0.5
non-iid partition finished
Data partitioned
Clients and server are initialized
Starting Training...
Epoch 0  		Train Acc: 0.0795	Train loss: 0.0012	Test Acc: 0.1034	Test loss: 0.0007	ASR: 0.0000	ASR loss: 0.0007
Epoch 1  		Train Acc: 0.0793	Train loss: 0.0012	Test Acc: 0.1047	Test loss: 0.0007	ASR: 0.0000	ASR loss: 0.0007
Epoch 2  		Train Acc: 0.0840	Train loss: 0.0012	Test Acc: 0.1088	Test loss: 0.0007	ASR: 0.0000	ASR loss: 0.0007
Epoch 3  		Train Acc: 0.0935	Train loss: 0.0012	Test Acc: 0.1197	Test loss: 0.0007	ASR: 0.0000	ASR loss: 0.0007
Epoch 4  		Train Acc: 0.1182	Train loss: 0.0012	Test Acc: 0.1605	Test loss: 0.0007	ASR: 0.0000	ASR loss: 0.0007
Epoch 5  		Train Acc: 0.1787	Train loss: 0.0012	Test Acc: 0.1003	Test loss: 0.0007	ASR: 0.0000	ASR loss: 0.0007
Epoch 6  		Train Acc: 0.1203	Train loss: 0.0012	Test Acc: 0.0974	Test loss: 0.0007	ASR: 0.0000	ASR loss: 0.0007
Epoch 7  		Train Acc: 0.1020	Train loss: 0.0012	Test Acc: 0.0974	Test loss: 0.0007	ASR: 0.0000	ASR loss: 0.0007
Epoch 8  		Train Acc: 0.1010	Train loss: 0.0012	Test Acc: 0.0974	Test loss: 0.0007	ASR: 0.0000	ASR loss: 0.0007
Epoch 9  		Train Acc: 0.1005	Train loss: 0.0012	Test Acc: 0.0974	Test loss: 0.0007	ASR: 0.0000	ASR loss: 0.0007
Epoch 10 		Train Acc: 0.1004	Train loss: 0.0012	Test Acc: 0.0974	Test loss: 0.0007	ASR: 0.0000	ASR loss: 0.0007
Epoch 11 		Train Acc: 0.1012	Train loss: 0.0012	Test Acc: 0.0974	Test loss: 0.0007	ASR: 0.0000	ASR loss: 0.0007
Epoch 12 		Train Acc: 0.1214	Train loss: 0.0012	Test Acc: 0.2014	Test loss: 0.0007	ASR: 0.0000	ASR loss: 0.0007
Epoch 13 		Train Acc: 0.2153	Train loss: 0.0012	Test Acc: 0.1767	Test loss: 0.0007	ASR: 0.0000	ASR loss: 0.0007
Epoch 14 		Train Acc: 0.2135	Train loss: 0.0012	Test Acc: 0.1905	Test loss: 0.0007	ASR: 0.0000	ASR loss: 0.0008
Epoch 15 		Train Acc: 0.2021	Train loss: 0.0011	Test Acc: 0.2008	Test loss: 0.0007	ASR: 0.0000	ASR loss: 0.0008
Epoch 16 		Train Acc: 0.2049	Train loss: 0.0011	Test Acc: 0.2010	Test loss: 0.0007	ASR: 0.0000	ASR loss: 0.0008
Epoch 17 		Train Acc: 0.2116	Train loss: 0.0011	Test Acc: 0.2033	Test loss: 0.0007	ASR: 0.0000	ASR loss: 0.0009
Epoch 18 		Train Acc: 0.2202	Train loss: 0.0011	Test Acc: 0.2751	Test loss: 0.0007	ASR: 0.0000	ASR loss: 0.0008
Epoch 19 		Train Acc: 0.3166	Train loss: 0.0011	Test Acc: 0.1546	Test loss: 0.0007	ASR: 0.0000	ASR loss: 0.0008
Epoch 20 		Train Acc: 0.1877	Train loss: 0.0011	Test Acc: 0.0978	Test loss: 0.0007	ASR: 0.0000	ASR loss: 0.0008
Epoch 21 		Train Acc: 0.1538	Train loss: 0.0011	Test Acc: 0.2775	Test loss: 0.0006	ASR: 0.0000	ASR loss: 0.0008
Epoch 22 		Train Acc: 0.3202	Train loss: 0.0010	Test Acc: 0.2617	Test loss: 0.0006	ASR: 0.0027	ASR loss: 0.0008
Epoch 23 		Train Acc: 0.3224	Train loss: 0.0010	Test Acc: 0.3102	Test loss: 0.0006	ASR: 0.0034	ASR loss: 0.0008
Epoch 24 		Train Acc: 0.3608	Train loss: 0.0009	Test Acc: 0.3414	Test loss: 0.0006	ASR: 0.0009	ASR loss: 0.0009
Epoch 25 		Train Acc: 0.3780	Train loss: 0.0009	Test Acc: 0.3864	Test loss: 0.0005	ASR: 0.0091	ASR loss: 0.0010
Epoch 26 		Train Acc: 0.4394	Train loss: 0.0008	Test Acc: 0.3695	Test loss: 0.0005	ASR: 0.0000	ASR loss: 0.0013
Epoch 27 		Train Acc: 0.4399	Train loss: 0.0008	Test Acc: 0.3761	Test loss: 0.0005	ASR: 0.0272	ASR loss: 0.0010
Epoch 28 		Train Acc: 0.4245	Train loss: 0.0008	Test Acc: 0.3461	Test loss: 0.0006	ASR: 0.0131	ASR loss: 0.0009
Epoch 29 		Train Acc: 0.4157	Train loss: 0.0009	Test Acc: 0.4602	Test loss: 0.0005	ASR: 0.0864	ASR loss: 0.0010
Epoch 30 		Train Acc: 0.5009	Train loss: 0.0007	Test Acc: 0.5505	Test loss: 0.0004	ASR: 0.1116	ASR loss: 0.0010
Epoch 31 		Train Acc: 0.5613	Train loss: 0.0007	Test Acc: 0.3595	Test loss: 0.0005	ASR: 0.0863	ASR loss: 0.0011
Epoch 32 		Train Acc: 0.4806	Train loss: 0.0007	Test Acc: 0.4862	Test loss: 0.0005	ASR: 0.2479	ASR loss: 0.0008
Epoch 33 		Train Acc: 0.5389	Train loss: 0.0007	Test Acc: 0.4875	Test loss: 0.0005	ASR: 0.1859	ASR loss: 0.0010
Epoch 34 		Train Acc: 0.5621	Train loss: 0.0007	Test Acc: 0.5260	Test loss: 0.0005	ASR: 0.0851	ASR loss: 0.0016
Epoch 35 		Train Acc: 0.5840	Train loss: 0.0007	Test Acc: 0.6308	Test loss: 0.0004	ASR: 0.0877	ASR loss: 0.0015
Epoch 36 		Train Acc: 0.6378	Train loss: 0.0007	Test Acc: 0.6757	Test loss: 0.0004	ASR: 0.1236	ASR loss: 0.0014
Epoch 37 		Train Acc: 0.6634	Train loss: 0.0006	Test Acc: 0.4640	Test loss: 0.0007	ASR: 0.2918	ASR loss: 0.0007
Epoch 38 		Train Acc: 0.5398	Train loss: 0.0009	Test Acc: 0.4997	Test loss: 0.0004	ASR: 0.0728	ASR loss: 0.0014
Epoch 39 		Train Acc: 0.5249	Train loss: 0.0007	Test Acc: 0.4891	Test loss: 0.0004	ASR: 0.0453	ASR loss: 0.0014
Epoch 40 		Train Acc: 0.5424	Train loss: 0.0007	Test Acc: 0.3712	Test loss: 0.0005	ASR: 0.0334	ASR loss: 0.0013
Epoch 41 		Train Acc: 0.4592	Train loss: 0.0007	Test Acc: 0.3962	Test loss: 0.0005	ASR: 0.0369	ASR loss: 0.0011
Epoch 42 		Train Acc: 0.4907	Train loss: 0.0007	Test Acc: 0.4997	Test loss: 0.0004	ASR: 0.0607	ASR loss: 0.0010
Epoch 43 		Train Acc: 0.5538	Train loss: 0.0007	Test Acc: 0.5993	Test loss: 0.0004	ASR: 0.0789	ASR loss: 0.0010
Epoch 44 		Train Acc: 0.6057	Train loss: 0.0007	Test Acc: 0.6368	Test loss: 0.0004	ASR: 0.0884	ASR loss: 0.0011
Epoch 45 		Train Acc: 0.6271	Train loss: 0.0007	Test Acc: 0.6497	Test loss: 0.0004	ASR: 0.0945	ASR loss: 0.0012
Epoch 46 		Train Acc: 0.6419	Train loss: 0.0006	Test Acc: 0.6509	Test loss: 0.0004	ASR: 0.1117	ASR loss: 0.0014
Epoch 47 		Train Acc: 0.6576	Train loss: 0.0006	Test Acc: 0.6732	Test loss: 0.0003	ASR: 0.1648	ASR loss: 0.0013
Epoch 48 		Train Acc: 0.6771	Train loss: 0.0006	Test Acc: 0.7188	Test loss: 0.0003	ASR: 0.1745	ASR loss: 0.0014
Epoch 49 		Train Acc: 0.6956	Train loss: 0.0006	Test Acc: 0.6480	Test loss: 0.0004	ASR: 0.1738	ASR loss: 0.0015
Epoch 50 		Train Acc: 0.6467	Train loss: 0.0006	Test Acc: 0.5802	Test loss: 0.0004	ASR: 0.2045	ASR loss: 0.0015
Epoch 51 		Train Acc: 0.6224	Train loss: 0.0007	Test Acc: 0.5504	Test loss: 0.0004	ASR: 0.1026	ASR loss: 0.0020
Epoch 52 		Train Acc: 0.6130	Train loss: 0.0007	Test Acc: 0.4751	Test loss: 0.0005	ASR: 0.0504	ASR loss: 0.0020
Epoch 53 		Train Acc: 0.5723	Train loss: 0.0007	Test Acc: 0.6446	Test loss: 0.0003	ASR: 0.1113	ASR loss: 0.0014
Epoch 54 		Train Acc: 0.6733	Train loss: 0.0006	Test Acc: 0.7075	Test loss: 0.0003	ASR: 0.1221	ASR loss: 0.0010
Epoch 55 		Train Acc: 0.7069	Train loss: 0.0006	Test Acc: 0.6918	Test loss: 0.0003	ASR: 0.1176	ASR loss: 0.0009
Epoch 56 		Train Acc: 0.6980	Train loss: 0.0006	Test Acc: 0.6531	Test loss: 0.0003	ASR: 0.1071	ASR loss: 0.0012
Epoch 57 		Train Acc: 0.6476	Train loss: 0.0006	Test Acc: 0.5219	Test loss: 0.0004	ASR: 0.0936	ASR loss: 0.0016
Epoch 58 		Train Acc: 0.5758	Train loss: 0.0006	Test Acc: 0.5838	Test loss: 0.0004	ASR: 0.1129	ASR loss: 0.0018
Epoch 59 		Train Acc: 0.6218	Train loss: 0.0006	Test Acc: 0.6752	Test loss: 0.0003	ASR: 0.1534	ASR loss: 0.0016
Epoch 60 		Train Acc: 0.6731	Train loss: 0.0005	Test Acc: 0.6995	Test loss: 0.0003	ASR: 0.1477	ASR loss: 0.0017
Epoch 61 		Train Acc: 0.6947	Train loss: 0.0005	Test Acc: 0.7277	Test loss: 0.0003	ASR: 0.1184	ASR loss: 0.0020
Epoch 62 		Train Acc: 0.7184	Train loss: 0.0005	Test Acc: 0.7657	Test loss: 0.0003	ASR: 0.1044	ASR loss: 0.0023
Epoch 63 		Train Acc: 0.7494	Train loss: 0.0005	Test Acc: 0.7983	Test loss: 0.0003	ASR: 0.1001	ASR loss: 0.0025
Epoch 64 		Train Acc: 0.7680	Train loss: 0.0005	Test Acc: 0.8042	Test loss: 0.0002	ASR: 0.1021	ASR loss: 0.0025
Epoch 65 		Train Acc: 0.7680	Train loss: 0.0005	Test Acc: 0.8060	Test loss: 0.0002	ASR: 0.1057	ASR loss: 0.0025
Epoch 66 		Train Acc: 0.7761	Train loss: 0.0005	Test Acc: 0.8023	Test loss: 0.0002	ASR: 0.1101	ASR loss: 0.0024
Epoch 67 		Train Acc: 0.7744	Train loss: 0.0005	Test Acc: 0.7962	Test loss: 0.0002	ASR: 0.1146	ASR loss: 0.0023
Epoch 68 		Train Acc: 0.7746	Train loss: 0.0004	Test Acc: 0.8006	Test loss: 0.0002	ASR: 0.1174	ASR loss: 0.0021
Epoch 69 		Train Acc: 0.7771	Train loss: 0.0004	Test Acc: 0.8123	Test loss: 0.0002	ASR: 0.1169	ASR loss: 0.0021
Epoch 70 		Train Acc: 0.7854	Train loss: 0.0004	Test Acc: 0.8218	Test loss: 0.0002	ASR: 0.1140	ASR loss: 0.0021
Epoch 71 		Train Acc: 0.7907	Train loss: 0.0004	Test Acc: 0.8252	Test loss: 0.0002	ASR: 0.1083	ASR loss: 0.0022
Epoch 72 		Train Acc: 0.7945	Train loss: 0.0004	Test Acc: 0.8236	Test loss: 0.0002	ASR: 0.1053	ASR loss: 0.0024
Epoch 73 		Train Acc: 0.7957	Train loss: 0.0004	Test Acc: 0.8231	Test loss: 0.0002	ASR: 0.1024	ASR loss: 0.0025
Epoch 74 		Train Acc: 0.7987	Train loss: 0.0004	Test Acc: 0.8261	Test loss: 0.0002	ASR: 0.1017	ASR loss: 0.0025
Epoch 75 		Train Acc: 0.8012	Train loss: 0.0004	Test Acc: 0.8400	Test loss: 0.0001	ASR: 0.1058	ASR loss: 0.0023
Epoch 76 		Train Acc: 0.8092	Train loss: 0.0004	Test Acc: 0.8396	Test loss: 0.0001	ASR: 0.1072	ASR loss: 0.0024
Epoch 77 		Train Acc: 0.8132	Train loss: 0.0003	Test Acc: 0.8381	Test loss: 0.0001	ASR: 0.1069	ASR loss: 0.0025
Epoch 78 		Train Acc: 0.8135	Train loss: 0.0003	Test Acc: 0.8325	Test loss: 0.0001	ASR: 0.1066	ASR loss: 0.0026
Epoch 79 		Train Acc: 0.8130	Train loss: 0.0003	Test Acc: 0.8480	Test loss: 0.0001	ASR: 0.1038	ASR loss: 0.0026
Epoch 80 		Train Acc: 0.8217	Train loss: 0.0003	Test Acc: 0.8656	Test loss: 0.0001	ASR: 0.1060	ASR loss: 0.0025
Epoch 81 		Train Acc: 0.8293	Train loss: 0.0003	Test Acc: 0.8348	Test loss: 0.0001	ASR: 0.1161	ASR loss: 0.0024
Epoch 82 		Train Acc: 0.8064	Train loss: 0.0003	Test Acc: 0.8066	Test loss: 0.0002	ASR: 0.1054	ASR loss: 0.0025
Epoch 83 		Train Acc: 0.7871	Train loss: 0.0004	Test Acc: 0.7674	Test loss: 0.0002	ASR: 0.0957	ASR loss: 0.0025
Epoch 84 		Train Acc: 0.7709	Train loss: 0.0004	Test Acc: 0.7865	Test loss: 0.0002	ASR: 0.0897	ASR loss: 0.0025
Epoch 85 		Train Acc: 0.7830	Train loss: 0.0004	Test Acc: 0.7999	Test loss: 0.0002	ASR: 0.0948	ASR loss: 0.0024
Epoch 86 		Train Acc: 0.7918	Train loss: 0.0004	Test Acc: 0.8403	Test loss: 0.0001	ASR: 0.1076	ASR loss: 0.0024
Epoch 87 		Train Acc: 0.7993	Train loss: 0.0004	Test Acc: 0.7783	Test loss: 0.0002	ASR: 0.1119	ASR loss: 0.0025
Epoch 88 		Train Acc: 0.7624	Train loss: 0.0004	Test Acc: 0.7878	Test loss: 0.0002	ASR: 0.1215	ASR loss: 0.0024
Epoch 89 		Train Acc: 0.7829	Train loss: 0.0004	Test Acc: 0.8212	Test loss: 0.0001	ASR: 0.1250	ASR loss: 0.0023
Epoch 90 		Train Acc: 0.8038	Train loss: 0.0003	Test Acc: 0.8341	Test loss: 0.0001	ASR: 0.1184	ASR loss: 0.0023
Epoch 91 		Train Acc: 0.8096	Train loss: 0.0004	Test Acc: 0.8385	Test loss: 0.0002	ASR: 0.1114	ASR loss: 0.0023
Epoch 92 		Train Acc: 0.8148	Train loss: 0.0003	Test Acc: 0.8207	Test loss: 0.0001	ASR: 0.1118	ASR loss: 0.0023
Epoch 93 		Train Acc: 0.8009	Train loss: 0.0004	Test Acc: 0.8213	Test loss: 0.0001	ASR: 0.1060	ASR loss: 0.0024
Epoch 94 		Train Acc: 0.8025	Train loss: 0.0004	Test Acc: 0.8370	Test loss: 0.0001	ASR: 0.1031	ASR loss: 0.0024
Epoch 95 		Train Acc: 0.8124	Train loss: 0.0003	Test Acc: 0.8517	Test loss: 0.0001	ASR: 0.1025	ASR loss: 0.0024
Epoch 96 		Train Acc: 0.8216	Train loss: 0.0003	Test Acc: 0.8444	Test loss: 0.0001	ASR: 0.1056	ASR loss: 0.0024
Epoch 97 		Train Acc: 0.8155	Train loss: 0.0003	Test Acc: 0.8159	Test loss: 0.0002	ASR: 0.1252	ASR loss: 0.0021
Epoch 98 		Train Acc: 0.8038	Train loss: 0.0004	Test Acc: 0.8476	Test loss: 0.0001	ASR: 0.1112	ASR loss: 0.0023
Epoch 99 		Train Acc: 0.8199	Train loss: 0.0003	Test Acc: 0.8397	Test loss: 0.0001	ASR: 0.1025	ASR loss: 0.0024
Training finished on Mon Jan 26 16:03:43 2026 using 63 minutes and 0 seconds in total.
