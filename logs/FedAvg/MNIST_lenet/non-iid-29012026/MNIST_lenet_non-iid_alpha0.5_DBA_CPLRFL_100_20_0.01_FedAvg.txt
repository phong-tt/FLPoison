seed: 4, epochs: 100, algorithm: FedAvg, optimizer: SGD, momentum: 0.9, weight_decay: 0.0005, num_clients: 20, batch_size: 4096, learning_rate: 0.01, local_epochs: 2, model: lenet, dataset: MNIST, distribution: non-iid, im_iid_gamma: 0.01, tail_cls_from: 4, dirichlet_alpha: 0.5, cache_partition: False, gpu_idx: [1], num_workers: 16, record_time: False, num_adv: 4, attack: DBA, defense: CPLRFL, attack_params: {'attack_model': 'all2one', 'scaling_factor': 100, 'trigger_factor': [8, 2, 0], 'poisoning_ratio': 0.32, 'source_label': 2, 'target_label': 7, 'attack_strategy': 'continuous'}, defense_params: {'samples_per_class': 50, 'similarity_metric': 'mmd', 'tau': 1.0, 'mmd_kernel': 'rbf', 'mmd_gamma': None}, benchmark: False, num_training_sample: 60000, num_channels: 1, num_classes: 10, mean: (0.1307,), std: (0.3081,), device: cuda:1, output: ./logs/FedAvg/MNIST_lenet/non-iid/MNIST_lenet_non-iid_alpha0.5_DBA_CPLRFL_100_20_0.01_FedAvg.txt

Started on Mon Jan 26 15:00:42 2026
Generating new indices
Doing non-iid partition
dirichlet alpha: 0.5
non-iid partition finished
Data partitioned
Clients and server are initialized
Starting Training...
Epoch 0  		Train Acc: 0.0795	Train loss: 0.0012	Test Acc: 0.1033	Test loss: 0.0007	ASR: 0.0000	ASR loss: 0.0007
Epoch 1  		Train Acc: 0.0792	Train loss: 0.0012	Test Acc: 0.1033	Test loss: 0.0007	ASR: 0.0000	ASR loss: 0.0007
Epoch 2  		Train Acc: 0.0802	Train loss: 0.0012	Test Acc: 0.1038	Test loss: 0.0007	ASR: 0.0000	ASR loss: 0.0007
Epoch 3  		Train Acc: 0.0849	Train loss: 0.0012	Test Acc: 0.1040	Test loss: 0.0007	ASR: 0.0000	ASR loss: 0.0007
Epoch 4  		Train Acc: 0.1135	Train loss: 0.0012	Test Acc: 0.1097	Test loss: 0.0007	ASR: 0.0104	ASR loss: 0.0007
Epoch 5  		Train Acc: 0.1506	Train loss: 0.0012	Test Acc: 0.1713	Test loss: 0.0007	ASR: 0.2653	ASR loss: 0.0007
Epoch 6  		Train Acc: 0.2097	Train loss: 0.0012	Test Acc: 0.1370	Test loss: 0.0007	ASR: 0.8200	ASR loss: 0.0007
Epoch 7  		Train Acc: 0.2218	Train loss: 0.0012	Test Acc: 0.1108	Test loss: 0.0007	ASR: 0.9832	ASR loss: 0.0007
Epoch 8  		Train Acc: 0.2158	Train loss: 0.0012	Test Acc: 0.1030	Test loss: 0.0007	ASR: 0.9996	ASR loss: 0.0007
Epoch 9  		Train Acc: 0.2150	Train loss: 0.0012	Test Acc: 0.1032	Test loss: 0.0007	ASR: 0.9997	ASR loss: 0.0006
Epoch 10 		Train Acc: 0.2199	Train loss: 0.0012	Test Acc: 0.1044	Test loss: 0.0007	ASR: 0.9982	ASR loss: 0.0006
Epoch 11 		Train Acc: 0.2277	Train loss: 0.0012	Test Acc: 0.1109	Test loss: 0.0007	ASR: 0.9910	ASR loss: 0.0006
Epoch 12 		Train Acc: 0.2360	Train loss: 0.0011	Test Acc: 0.1212	Test loss: 0.0007	ASR: 0.9792	ASR loss: 0.0006
Epoch 13 		Train Acc: 0.2472	Train loss: 0.0011	Test Acc: 0.1324	Test loss: 0.0007	ASR: 0.9672	ASR loss: 0.0006
Epoch 14 		Train Acc: 0.2588	Train loss: 0.0011	Test Acc: 0.1437	Test loss: 0.0007	ASR: 0.9541	ASR loss: 0.0006
Epoch 15 		Train Acc: 0.2684	Train loss: 0.0011	Test Acc: 0.1540	Test loss: 0.0007	ASR: 0.9421	ASR loss: 0.0006
Epoch 16 		Train Acc: 0.2788	Train loss: 0.0011	Test Acc: 0.1621	Test loss: 0.0007	ASR: 0.9322	ASR loss: 0.0006
Epoch 17 		Train Acc: 0.2910	Train loss: 0.0011	Test Acc: 0.1685	Test loss: 0.0007	ASR: 0.9227	ASR loss: 0.0006
Epoch 18 		Train Acc: 0.3084	Train loss: 0.0011	Test Acc: 0.1730	Test loss: 0.0007	ASR: 0.9136	ASR loss: 0.0005
Epoch 19 		Train Acc: 0.3296	Train loss: 0.0010	Test Acc: 0.1783	Test loss: 0.0006	ASR: 0.9018	ASR loss: 0.0005
Epoch 20 		Train Acc: 0.3443	Train loss: 0.0010	Test Acc: 0.1881	Test loss: 0.0006	ASR: 0.8714	ASR loss: 0.0005
Epoch 21 		Train Acc: 0.3618	Train loss: 0.0010	Test Acc: 0.2869	Test loss: 0.0006	ASR: 0.7040	ASR loss: 0.0005
Epoch 22 		Train Acc: 0.4090	Train loss: 0.0009	Test Acc: 0.4580	Test loss: 0.0006	ASR: 0.4447	ASR loss: 0.0006
Epoch 23 		Train Acc: 0.4904	Train loss: 0.0008	Test Acc: 0.5330	Test loss: 0.0005	ASR: 0.3433	ASR loss: 0.0006
Epoch 24 		Train Acc: 0.5366	Train loss: 0.0008	Test Acc: 0.5719	Test loss: 0.0005	ASR: 0.3027	ASR loss: 0.0006
Epoch 25 		Train Acc: 0.5720	Train loss: 0.0007	Test Acc: 0.6447	Test loss: 0.0004	ASR: 0.2167	ASR loss: 0.0007
Epoch 26 		Train Acc: 0.6170	Train loss: 0.0007	Test Acc: 0.7045	Test loss: 0.0004	ASR: 0.1731	ASR loss: 0.0008
Epoch 27 		Train Acc: 0.6582	Train loss: 0.0006	Test Acc: 0.7230	Test loss: 0.0003	ASR: 0.1556	ASR loss: 0.0009
Epoch 28 		Train Acc: 0.6823	Train loss: 0.0006	Test Acc: 0.7301	Test loss: 0.0003	ASR: 0.1580	ASR loss: 0.0009
Epoch 29 		Train Acc: 0.6843	Train loss: 0.0005	Test Acc: 0.7626	Test loss: 0.0002	ASR: 0.1206	ASR loss: 0.0011
Epoch 30 		Train Acc: 0.7107	Train loss: 0.0005	Test Acc: 0.7656	Test loss: 0.0002	ASR: 0.1381	ASR loss: 0.0010
Epoch 31 		Train Acc: 0.7038	Train loss: 0.0005	Test Acc: 0.7803	Test loss: 0.0002	ASR: 0.1278	ASR loss: 0.0011
Epoch 32 		Train Acc: 0.7335	Train loss: 0.0004	Test Acc: 0.7854	Test loss: 0.0002	ASR: 0.1198	ASR loss: 0.0011
Epoch 33 		Train Acc: 0.7377	Train loss: 0.0004	Test Acc: 0.7903	Test loss: 0.0002	ASR: 0.1322	ASR loss: 0.0010
Epoch 34 		Train Acc: 0.7571	Train loss: 0.0004	Test Acc: 0.8093	Test loss: 0.0002	ASR: 0.1235	ASR loss: 0.0011
Epoch 35 		Train Acc: 0.7648	Train loss: 0.0004	Test Acc: 0.8195	Test loss: 0.0002	ASR: 0.1208	ASR loss: 0.0011
Epoch 36 		Train Acc: 0.7764	Train loss: 0.0004	Test Acc: 0.8270	Test loss: 0.0002	ASR: 0.1216	ASR loss: 0.0011
Epoch 37 		Train Acc: 0.7817	Train loss: 0.0003	Test Acc: 0.8332	Test loss: 0.0002	ASR: 0.1222	ASR loss: 0.0012
Epoch 38 		Train Acc: 0.7872	Train loss: 0.0003	Test Acc: 0.8414	Test loss: 0.0002	ASR: 0.1198	ASR loss: 0.0012
Epoch 39 		Train Acc: 0.7925	Train loss: 0.0003	Test Acc: 0.8472	Test loss: 0.0001	ASR: 0.1176	ASR loss: 0.0012
Epoch 40 		Train Acc: 0.7991	Train loss: 0.0003	Test Acc: 0.8532	Test loss: 0.0001	ASR: 0.1152	ASR loss: 0.0012
Epoch 41 		Train Acc: 0.8022	Train loss: 0.0003	Test Acc: 0.8572	Test loss: 0.0001	ASR: 0.1157	ASR loss: 0.0011
Epoch 42 		Train Acc: 0.8070	Train loss: 0.0003	Test Acc: 0.8647	Test loss: 0.0001	ASR: 0.1160	ASR loss: 0.0011
Epoch 43 		Train Acc: 0.8130	Train loss: 0.0003	Test Acc: 0.8686	Test loss: 0.0001	ASR: 0.1162	ASR loss: 0.0011
Epoch 44 		Train Acc: 0.8155	Train loss: 0.0003	Test Acc: 0.8744	Test loss: 0.0001	ASR: 0.1153	ASR loss: 0.0011
Epoch 45 		Train Acc: 0.8203	Train loss: 0.0003	Test Acc: 0.8784	Test loss: 0.0001	ASR: 0.1141	ASR loss: 0.0011
Epoch 46 		Train Acc: 0.8223	Train loss: 0.0003	Test Acc: 0.8803	Test loss: 0.0001	ASR: 0.1149	ASR loss: 0.0010
Epoch 47 		Train Acc: 0.8266	Train loss: 0.0003	Test Acc: 0.8835	Test loss: 0.0001	ASR: 0.1140	ASR loss: 0.0010
Epoch 48 		Train Acc: 0.8292	Train loss: 0.0003	Test Acc: 0.8864	Test loss: 0.0001	ASR: 0.1132	ASR loss: 0.0010
Epoch 49 		Train Acc: 0.8304	Train loss: 0.0003	Test Acc: 0.8896	Test loss: 0.0001	ASR: 0.1130	ASR loss: 0.0010
Epoch 50 		Train Acc: 0.8341	Train loss: 0.0003	Test Acc: 0.8917	Test loss: 0.0001	ASR: 0.1123	ASR loss: 0.0010
Epoch 51 		Train Acc: 0.8378	Train loss: 0.0002	Test Acc: 0.8926	Test loss: 0.0001	ASR: 0.1121	ASR loss: 0.0011
Epoch 52 		Train Acc: 0.8374	Train loss: 0.0002	Test Acc: 0.8948	Test loss: 0.0001	ASR: 0.1116	ASR loss: 0.0011
Epoch 53 		Train Acc: 0.8418	Train loss: 0.0002	Test Acc: 0.8970	Test loss: 0.0001	ASR: 0.1104	ASR loss: 0.0011
Epoch 54 		Train Acc: 0.8440	Train loss: 0.0002	Test Acc: 0.8982	Test loss: 0.0001	ASR: 0.1107	ASR loss: 0.0011
Epoch 55 		Train Acc: 0.8448	Train loss: 0.0002	Test Acc: 0.9009	Test loss: 0.0001	ASR: 0.1098	ASR loss: 0.0010
Epoch 56 		Train Acc: 0.8462	Train loss: 0.0002	Test Acc: 0.9028	Test loss: 0.0001	ASR: 0.1096	ASR loss: 0.0010
Epoch 57 		Train Acc: 0.8473	Train loss: 0.0002	Test Acc: 0.9048	Test loss: 0.0001	ASR: 0.1090	ASR loss: 0.0010
Epoch 58 		Train Acc: 0.8501	Train loss: 0.0002	Test Acc: 0.9075	Test loss: 0.0001	ASR: 0.1091	ASR loss: 0.0010
Epoch 59 		Train Acc: 0.8511	Train loss: 0.0002	Test Acc: 0.9086	Test loss: 0.0001	ASR: 0.1088	ASR loss: 0.0010
Epoch 60 		Train Acc: 0.8524	Train loss: 0.0002	Test Acc: 0.9114	Test loss: 0.0001	ASR: 0.1092	ASR loss: 0.0010
Epoch 61 		Train Acc: 0.8531	Train loss: 0.0002	Test Acc: 0.9131	Test loss: 0.0001	ASR: 0.1088	ASR loss: 0.0010
Epoch 62 		Train Acc: 0.8544	Train loss: 0.0002	Test Acc: 0.9144	Test loss: 0.0001	ASR: 0.1090	ASR loss: 0.0010
Epoch 63 		Train Acc: 0.8553	Train loss: 0.0002	Test Acc: 0.9154	Test loss: 0.0001	ASR: 0.1090	ASR loss: 0.0010
Epoch 64 		Train Acc: 0.8572	Train loss: 0.0002	Test Acc: 0.9169	Test loss: 0.0001	ASR: 0.1090	ASR loss: 0.0010
Epoch 65 		Train Acc: 0.8588	Train loss: 0.0002	Test Acc: 0.9179	Test loss: 0.0001	ASR: 0.1089	ASR loss: 0.0010
Epoch 66 		Train Acc: 0.8601	Train loss: 0.0002	Test Acc: 0.9179	Test loss: 0.0001	ASR: 0.1092	ASR loss: 0.0010
Epoch 67 		Train Acc: 0.8612	Train loss: 0.0002	Test Acc: 0.9193	Test loss: 0.0001	ASR: 0.1095	ASR loss: 0.0010
Epoch 68 		Train Acc: 0.8616	Train loss: 0.0002	Test Acc: 0.9204	Test loss: 0.0001	ASR: 0.1096	ASR loss: 0.0010
Epoch 69 		Train Acc: 0.8638	Train loss: 0.0002	Test Acc: 0.9212	Test loss: 0.0001	ASR: 0.1096	ASR loss: 0.0010
Epoch 70 		Train Acc: 0.8643	Train loss: 0.0002	Test Acc: 0.9230	Test loss: 0.0001	ASR: 0.1093	ASR loss: 0.0010
Epoch 71 		Train Acc: 0.8663	Train loss: 0.0002	Test Acc: 0.9247	Test loss: 0.0001	ASR: 0.1084	ASR loss: 0.0010
Epoch 72 		Train Acc: 0.8671	Train loss: 0.0002	Test Acc: 0.9264	Test loss: 0.0001	ASR: 0.1081	ASR loss: 0.0010
Epoch 73 		Train Acc: 0.8675	Train loss: 0.0002	Test Acc: 0.9275	Test loss: 0.0001	ASR: 0.1085	ASR loss: 0.0010
Epoch 74 		Train Acc: 0.8688	Train loss: 0.0002	Test Acc: 0.9287	Test loss: 0.0001	ASR: 0.1088	ASR loss: 0.0010
Epoch 75 		Train Acc: 0.8706	Train loss: 0.0002	Test Acc: 0.9292	Test loss: 0.0001	ASR: 0.1086	ASR loss: 0.0010
Epoch 76 		Train Acc: 0.8697	Train loss: 0.0002	Test Acc: 0.9301	Test loss: 0.0001	ASR: 0.1085	ASR loss: 0.0010
Epoch 77 		Train Acc: 0.8722	Train loss: 0.0002	Test Acc: 0.9312	Test loss: 0.0001	ASR: 0.1081	ASR loss: 0.0010
Epoch 78 		Train Acc: 0.8710	Train loss: 0.0002	Test Acc: 0.9320	Test loss: 0.0001	ASR: 0.1085	ASR loss: 0.0010
Epoch 79 		Train Acc: 0.8754	Train loss: 0.0002	Test Acc: 0.9328	Test loss: 0.0001	ASR: 0.1084	ASR loss: 0.0010
Epoch 80 		Train Acc: 0.8727	Train loss: 0.0002	Test Acc: 0.9334	Test loss: 0.0001	ASR: 0.1085	ASR loss: 0.0010
Epoch 81 		Train Acc: 0.8774	Train loss: 0.0002	Test Acc: 0.9352	Test loss: 0.0001	ASR: 0.1084	ASR loss: 0.0010
Epoch 82 		Train Acc: 0.8749	Train loss: 0.0002	Test Acc: 0.9369	Test loss: 0.0001	ASR: 0.1085	ASR loss: 0.0010
Epoch 83 		Train Acc: 0.8763	Train loss: 0.0002	Test Acc: 0.9374	Test loss: 0.0001	ASR: 0.1080	ASR loss: 0.0010
Epoch 84 		Train Acc: 0.8781	Train loss: 0.0002	Test Acc: 0.9387	Test loss: 0.0001	ASR: 0.1084	ASR loss: 0.0010
Epoch 85 		Train Acc: 0.8781	Train loss: 0.0002	Test Acc: 0.9397	Test loss: 0.0001	ASR: 0.1088	ASR loss: 0.0010
Epoch 86 		Train Acc: 0.8768	Train loss: 0.0002	Test Acc: 0.9406	Test loss: 0.0001	ASR: 0.1087	ASR loss: 0.0010
Epoch 87 		Train Acc: 0.8806	Train loss: 0.0002	Test Acc: 0.9414	Test loss: 0.0001	ASR: 0.1080	ASR loss: 0.0010
Epoch 88 		Train Acc: 0.8807	Train loss: 0.0002	Test Acc: 0.9421	Test loss: 0.0001	ASR: 0.1078	ASR loss: 0.0010
Epoch 89 		Train Acc: 0.8807	Train loss: 0.0002	Test Acc: 0.9429	Test loss: 0.0001	ASR: 0.1077	ASR loss: 0.0010
Epoch 90 		Train Acc: 0.8786	Train loss: 0.0002	Test Acc: 0.9436	Test loss: 0.0001	ASR: 0.1076	ASR loss: 0.0010
Epoch 91 		Train Acc: 0.8815	Train loss: 0.0002	Test Acc: 0.9443	Test loss: 0.0001	ASR: 0.1075	ASR loss: 0.0010
Epoch 92 		Train Acc: 0.8812	Train loss: 0.0002	Test Acc: 0.9443	Test loss: 0.0001	ASR: 0.1071	ASR loss: 0.0010
Epoch 93 		Train Acc: 0.8815	Train loss: 0.0002	Test Acc: 0.9457	Test loss: 0.0001	ASR: 0.1073	ASR loss: 0.0010
Epoch 94 		Train Acc: 0.8816	Train loss: 0.0002	Test Acc: 0.9466	Test loss: 0.0001	ASR: 0.1071	ASR loss: 0.0010
Epoch 95 		Train Acc: 0.8819	Train loss: 0.0002	Test Acc: 0.9467	Test loss: 0.0001	ASR: 0.1073	ASR loss: 0.0010
Epoch 96 		Train Acc: 0.8850	Train loss: 0.0002	Test Acc: 0.9475	Test loss: 0.0001	ASR: 0.1075	ASR loss: 0.0010
Epoch 97 		Train Acc: 0.8847	Train loss: 0.0002	Test Acc: 0.9475	Test loss: 0.0001	ASR: 0.1072	ASR loss: 0.0010
Epoch 98 		Train Acc: 0.8852	Train loss: 0.0002	Test Acc: 0.9481	Test loss: 0.0001	ASR: 0.1070	ASR loss: 0.0010
Epoch 99 		Train Acc: 0.8872	Train loss: 0.0002	Test Acc: 0.9487	Test loss: 0.0001	ASR: 0.1071	ASR loss: 0.0010
Training finished on Mon Jan 26 16:06:18 2026 using 65 minutes and 36 seconds in total.
