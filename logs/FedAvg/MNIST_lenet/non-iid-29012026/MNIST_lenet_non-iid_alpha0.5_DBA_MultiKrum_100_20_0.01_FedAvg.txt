seed: 4, epochs: 100, algorithm: FedAvg, optimizer: SGD, momentum: 0.9, weight_decay: 0.0005, num_clients: 20, batch_size: 4096, learning_rate: 0.01, local_epochs: 2, model: lenet, dataset: MNIST, distribution: non-iid, im_iid_gamma: 0.01, tail_cls_from: 4, dirichlet_alpha: 0.5, cache_partition: False, gpu_idx: [1], num_workers: 16, record_time: False, num_adv: 4, attack: DBA, defense: MultiKrum, attack_params: {'attack_model': 'all2one', 'scaling_factor': 100, 'trigger_factor': [8, 2, 0], 'poisoning_ratio': 0.32, 'source_label': 2, 'target_label': 7, 'attack_strategy': 'continuous'}, defense_params: {'aux_data_num': 100, 'selected_class': 1, 'tau': 1.0, 'mmd_kernel': 'rbf', 'mmd_gamma': None}, benchmark: False, num_training_sample: 60000, num_channels: 1, num_classes: 10, mean: (0.1307,), std: (0.3081,), device: cuda:1, output: ./logs/FedAvg/MNIST_lenet/non-iid/MNIST_lenet_non-iid_alpha0.5_DBA_MultiKrum_100_20_0.01_FedAvg.txt

Started on Mon Jan 26 15:00:42 2026
Generating new indices
Doing non-iid partition
dirichlet alpha: 0.5
non-iid partition finished
Data partitioned
Clients and server are initialized
Starting Training...
Epoch 0  		Train Acc: 0.0795	Train loss: 0.0012	Test Acc: 0.1033	Test loss: 0.0007	ASR: 0.0000	ASR loss: 0.0007
Epoch 1  		Train Acc: 0.0791	Train loss: 0.0012	Test Acc: 0.1037	Test loss: 0.0007	ASR: 0.0000	ASR loss: 0.0007
Epoch 2  		Train Acc: 0.0816	Train loss: 0.0012	Test Acc: 0.1051	Test loss: 0.0007	ASR: 0.0000	ASR loss: 0.0007
Epoch 3  		Train Acc: 0.0874	Train loss: 0.0012	Test Acc: 0.1084	Test loss: 0.0007	ASR: 0.0000	ASR loss: 0.0007
Epoch 4  		Train Acc: 0.1010	Train loss: 0.0012	Test Acc: 0.1171	Test loss: 0.0007	ASR: 0.0000	ASR loss: 0.0007
Epoch 5  		Train Acc: 0.1433	Train loss: 0.0012	Test Acc: 0.1680	Test loss: 0.0007	ASR: 0.0001	ASR loss: 0.0007
Epoch 6  		Train Acc: 0.2062	Train loss: 0.0012	Test Acc: 0.2334	Test loss: 0.0007	ASR: 0.0067	ASR loss: 0.0007
Epoch 7  		Train Acc: 0.2602	Train loss: 0.0012	Test Acc: 0.2615	Test loss: 0.0007	ASR: 0.0362	ASR loss: 0.0007
Epoch 8  		Train Acc: 0.2779	Train loss: 0.0012	Test Acc: 0.2146	Test loss: 0.0007	ASR: 0.0367	ASR loss: 0.0007
Epoch 9  		Train Acc: 0.2551	Train loss: 0.0012	Test Acc: 0.1623	Test loss: 0.0007	ASR: 0.0226	ASR loss: 0.0007
Epoch 10 		Train Acc: 0.2269	Train loss: 0.0012	Test Acc: 0.1353	Test loss: 0.0007	ASR: 0.0119	ASR loss: 0.0007
Epoch 11 		Train Acc: 0.2103	Train loss: 0.0012	Test Acc: 0.1322	Test loss: 0.0007	ASR: 0.0060	ASR loss: 0.0007
Epoch 12 		Train Acc: 0.2124	Train loss: 0.0012	Test Acc: 0.1439	Test loss: 0.0007	ASR: 0.0034	ASR loss: 0.0007
Epoch 13 		Train Acc: 0.2241	Train loss: 0.0011	Test Acc: 0.1583	Test loss: 0.0007	ASR: 0.0039	ASR loss: 0.0007
Epoch 14 		Train Acc: 0.2407	Train loss: 0.0011	Test Acc: 0.1694	Test loss: 0.0007	ASR: 0.0045	ASR loss: 0.0007
Epoch 15 		Train Acc: 0.2515	Train loss: 0.0011	Test Acc: 0.1808	Test loss: 0.0007	ASR: 0.0061	ASR loss: 0.0007
Epoch 16 		Train Acc: 0.2677	Train loss: 0.0011	Test Acc: 0.1882	Test loss: 0.0007	ASR: 0.0084	ASR loss: 0.0007
Epoch 17 		Train Acc: 0.2820	Train loss: 0.0011	Test Acc: 0.1965	Test loss: 0.0007	ASR: 0.0115	ASR loss: 0.0007
Epoch 18 		Train Acc: 0.2942	Train loss: 0.0011	Test Acc: 0.2154	Test loss: 0.0006	ASR: 0.0177	ASR loss: 0.0007
Epoch 19 		Train Acc: 0.3139	Train loss: 0.0010	Test Acc: 0.2606	Test loss: 0.0006	ASR: 0.0304	ASR loss: 0.0007
Epoch 20 		Train Acc: 0.3486	Train loss: 0.0010	Test Acc: 0.3297	Test loss: 0.0006	ASR: 0.0513	ASR loss: 0.0007
Epoch 21 		Train Acc: 0.3964	Train loss: 0.0009	Test Acc: 0.4124	Test loss: 0.0006	ASR: 0.0828	ASR loss: 0.0007
Epoch 22 		Train Acc: 0.4453	Train loss: 0.0009	Test Acc: 0.4629	Test loss: 0.0005	ASR: 0.1290	ASR loss: 0.0007
Epoch 23 		Train Acc: 0.4858	Train loss: 0.0008	Test Acc: 0.4018	Test loss: 0.0005	ASR: 0.0360	ASR loss: 0.0010
Epoch 24 		Train Acc: 0.4663	Train loss: 0.0008	Test Acc: 0.4339	Test loss: 0.0005	ASR: 0.0558	ASR loss: 0.0011
Epoch 25 		Train Acc: 0.4899	Train loss: 0.0008	Test Acc: 0.4994	Test loss: 0.0004	ASR: 0.1149	ASR loss: 0.0008
Epoch 26 		Train Acc: 0.5263	Train loss: 0.0007	Test Acc: 0.5615	Test loss: 0.0004	ASR: 0.1507	ASR loss: 0.0009
Epoch 27 		Train Acc: 0.5580	Train loss: 0.0007	Test Acc: 0.5586	Test loss: 0.0004	ASR: 0.1064	ASR loss: 0.0012
Epoch 28 		Train Acc: 0.5787	Train loss: 0.0007	Test Acc: 0.6211	Test loss: 0.0003	ASR: 0.1410	ASR loss: 0.0011
Epoch 29 		Train Acc: 0.6139	Train loss: 0.0006	Test Acc: 0.6511	Test loss: 0.0003	ASR: 0.1089	ASR loss: 0.0014
Epoch 30 		Train Acc: 0.6379	Train loss: 0.0006	Test Acc: 0.6786	Test loss: 0.0003	ASR: 0.1110	ASR loss: 0.0016
Epoch 31 		Train Acc: 0.6526	Train loss: 0.0006	Test Acc: 0.6965	Test loss: 0.0002	ASR: 0.1333	ASR loss: 0.0015
Epoch 32 		Train Acc: 0.6817	Train loss: 0.0005	Test Acc: 0.7124	Test loss: 0.0002	ASR: 0.1189	ASR loss: 0.0018
Epoch 33 		Train Acc: 0.6863	Train loss: 0.0005	Test Acc: 0.7344	Test loss: 0.0002	ASR: 0.1122	ASR loss: 0.0019
Epoch 34 		Train Acc: 0.7075	Train loss: 0.0005	Test Acc: 0.7631	Test loss: 0.0002	ASR: 0.1178	ASR loss: 0.0019
Epoch 35 		Train Acc: 0.7193	Train loss: 0.0005	Test Acc: 0.7737	Test loss: 0.0002	ASR: 0.1097	ASR loss: 0.0021
Epoch 36 		Train Acc: 0.7358	Train loss: 0.0004	Test Acc: 0.7768	Test loss: 0.0002	ASR: 0.1014	ASR loss: 0.0023
Epoch 37 		Train Acc: 0.7302	Train loss: 0.0005	Test Acc: 0.7922	Test loss: 0.0002	ASR: 0.1087	ASR loss: 0.0022
Epoch 38 		Train Acc: 0.7510	Train loss: 0.0004	Test Acc: 0.7999	Test loss: 0.0002	ASR: 0.1128	ASR loss: 0.0022
Epoch 39 		Train Acc: 0.7520	Train loss: 0.0004	Test Acc: 0.7965	Test loss: 0.0002	ASR: 0.1066	ASR loss: 0.0024
Epoch 40 		Train Acc: 0.7611	Train loss: 0.0004	Test Acc: 0.8072	Test loss: 0.0002	ASR: 0.1040	ASR loss: 0.0024
Epoch 41 		Train Acc: 0.7588	Train loss: 0.0005	Test Acc: 0.8188	Test loss: 0.0002	ASR: 0.1058	ASR loss: 0.0024
Epoch 42 		Train Acc: 0.7761	Train loss: 0.0004	Test Acc: 0.8207	Test loss: 0.0001	ASR: 0.1064	ASR loss: 0.0024
Epoch 43 		Train Acc: 0.7679	Train loss: 0.0004	Test Acc: 0.8228	Test loss: 0.0001	ASR: 0.1062	ASR loss: 0.0024
Epoch 44 		Train Acc: 0.7802	Train loss: 0.0004	Test Acc: 0.8289	Test loss: 0.0001	ASR: 0.1060	ASR loss: 0.0024
Epoch 45 		Train Acc: 0.7757	Train loss: 0.0004	Test Acc: 0.8368	Test loss: 0.0001	ASR: 0.1050	ASR loss: 0.0024
Epoch 46 		Train Acc: 0.7871	Train loss: 0.0004	Test Acc: 0.8370	Test loss: 0.0001	ASR: 0.1038	ASR loss: 0.0025
Epoch 47 		Train Acc: 0.7809	Train loss: 0.0004	Test Acc: 0.8396	Test loss: 0.0001	ASR: 0.1056	ASR loss: 0.0024
Epoch 48 		Train Acc: 0.7940	Train loss: 0.0004	Test Acc: 0.8468	Test loss: 0.0001	ASR: 0.1077	ASR loss: 0.0024
Epoch 49 		Train Acc: 0.7879	Train loss: 0.0004	Test Acc: 0.8478	Test loss: 0.0001	ASR: 0.1058	ASR loss: 0.0025
Epoch 50 		Train Acc: 0.7998	Train loss: 0.0004	Test Acc: 0.8501	Test loss: 0.0001	ASR: 0.1048	ASR loss: 0.0025
Epoch 51 		Train Acc: 0.7911	Train loss: 0.0004	Test Acc: 0.8573	Test loss: 0.0001	ASR: 0.1054	ASR loss: 0.0025
Epoch 52 		Train Acc: 0.8071	Train loss: 0.0003	Test Acc: 0.8614	Test loss: 0.0001	ASR: 0.1054	ASR loss: 0.0025
Epoch 53 		Train Acc: 0.8003	Train loss: 0.0004	Test Acc: 0.8649	Test loss: 0.0001	ASR: 0.1040	ASR loss: 0.0025
Epoch 54 		Train Acc: 0.8140	Train loss: 0.0003	Test Acc: 0.8680	Test loss: 0.0001	ASR: 0.1041	ASR loss: 0.0025
Epoch 55 		Train Acc: 0.8043	Train loss: 0.0004	Test Acc: 0.8407	Test loss: 0.0001	ASR: 0.0870	ASR loss: 0.0028
Epoch 56 		Train Acc: 0.8026	Train loss: 0.0004	Test Acc: 0.8730	Test loss: 0.0001	ASR: 0.0892	ASR loss: 0.0027
Epoch 57 		Train Acc: 0.8062	Train loss: 0.0004	Test Acc: 0.8772	Test loss: 0.0001	ASR: 0.0945	ASR loss: 0.0026
Epoch 58 		Train Acc: 0.8207	Train loss: 0.0003	Test Acc: 0.8833	Test loss: 0.0001	ASR: 0.0988	ASR loss: 0.0026
Epoch 59 		Train Acc: 0.8136	Train loss: 0.0004	Test Acc: 0.8927	Test loss: 0.0001	ASR: 0.0995	ASR loss: 0.0026
Epoch 60 		Train Acc: 0.8289	Train loss: 0.0003	Test Acc: 0.8942	Test loss: 0.0001	ASR: 0.0981	ASR loss: 0.0026
Epoch 61 		Train Acc: 0.8254	Train loss: 0.0003	Test Acc: 0.8960	Test loss: 0.0001	ASR: 0.0956	ASR loss: 0.0027
Epoch 62 		Train Acc: 0.8373	Train loss: 0.0003	Test Acc: 0.9009	Test loss: 0.0001	ASR: 0.0953	ASR loss: 0.0028
Epoch 63 		Train Acc: 0.8291	Train loss: 0.0004	Test Acc: 0.9036	Test loss: 0.0001	ASR: 0.0974	ASR loss: 0.0028
Epoch 64 		Train Acc: 0.8426	Train loss: 0.0003	Test Acc: 0.9019	Test loss: 0.0001	ASR: 0.0975	ASR loss: 0.0028
Epoch 65 		Train Acc: 0.8311	Train loss: 0.0004	Test Acc: 0.9056	Test loss: 0.0001	ASR: 0.0957	ASR loss: 0.0029
Epoch 66 		Train Acc: 0.8436	Train loss: 0.0003	Test Acc: 0.9096	Test loss: 0.0001	ASR: 0.0950	ASR loss: 0.0029
Epoch 67 		Train Acc: 0.8364	Train loss: 0.0003	Test Acc: 0.9111	Test loss: 0.0001	ASR: 0.0966	ASR loss: 0.0029
Epoch 68 		Train Acc: 0.8477	Train loss: 0.0003	Test Acc: 0.9082	Test loss: 0.0001	ASR: 0.1000	ASR loss: 0.0028
Epoch 69 		Train Acc: 0.8364	Train loss: 0.0003	Test Acc: 0.9065	Test loss: 0.0001	ASR: 0.1027	ASR loss: 0.0028
Epoch 70 		Train Acc: 0.8442	Train loss: 0.0003	Test Acc: 0.9132	Test loss: 0.0001	ASR: 0.1011	ASR loss: 0.0028
Epoch 71 		Train Acc: 0.8444	Train loss: 0.0003	Test Acc: 0.9190	Test loss: 0.0001	ASR: 0.0964	ASR loss: 0.0029
Epoch 72 		Train Acc: 0.8531	Train loss: 0.0003	Test Acc: 0.9156	Test loss: 0.0001	ASR: 0.0924	ASR loss: 0.0030
Epoch 73 		Train Acc: 0.8455	Train loss: 0.0003	Test Acc: 0.9181	Test loss: 0.0001	ASR: 0.0946	ASR loss: 0.0029
Epoch 74 		Train Acc: 0.8511	Train loss: 0.0003	Test Acc: 0.9216	Test loss: 0.0001	ASR: 0.0991	ASR loss: 0.0028
Epoch 75 		Train Acc: 0.8468	Train loss: 0.0003	Test Acc: 0.9235	Test loss: 0.0001	ASR: 0.1016	ASR loss: 0.0028
Epoch 76 		Train Acc: 0.8560	Train loss: 0.0003	Test Acc: 0.9244	Test loss: 0.0001	ASR: 0.1006	ASR loss: 0.0029
Epoch 77 		Train Acc: 0.8503	Train loss: 0.0003	Test Acc: 0.9229	Test loss: 0.0001	ASR: 0.0985	ASR loss: 0.0029
Epoch 78 		Train Acc: 0.8578	Train loss: 0.0003	Test Acc: 0.9232	Test loss: 0.0001	ASR: 0.0971	ASR loss: 0.0030
Epoch 79 		Train Acc: 0.8502	Train loss: 0.0003	Test Acc: 0.9256	Test loss: 0.0001	ASR: 0.0973	ASR loss: 0.0030
Epoch 80 		Train Acc: 0.8593	Train loss: 0.0003	Test Acc: 0.9287	Test loss: 0.0001	ASR: 0.0987	ASR loss: 0.0030
Epoch 81 		Train Acc: 0.8545	Train loss: 0.0003	Test Acc: 0.9303	Test loss: 0.0001	ASR: 0.1005	ASR loss: 0.0030
Epoch 82 		Train Acc: 0.8625	Train loss: 0.0003	Test Acc: 0.9313	Test loss: 0.0001	ASR: 0.1009	ASR loss: 0.0030
Epoch 83 		Train Acc: 0.8554	Train loss: 0.0003	Test Acc: 0.9314	Test loss: 0.0001	ASR: 0.0995	ASR loss: 0.0030
Epoch 84 		Train Acc: 0.8635	Train loss: 0.0003	Test Acc: 0.9311	Test loss: 0.0001	ASR: 0.0992	ASR loss: 0.0030
Epoch 85 		Train Acc: 0.8577	Train loss: 0.0003	Test Acc: 0.9326	Test loss: 0.0001	ASR: 0.0987	ASR loss: 0.0031
Epoch 86 		Train Acc: 0.8647	Train loss: 0.0003	Test Acc: 0.9342	Test loss: 0.0001	ASR: 0.0989	ASR loss: 0.0031
Epoch 87 		Train Acc: 0.8609	Train loss: 0.0003	Test Acc: 0.9353	Test loss: 0.0001	ASR: 0.1000	ASR loss: 0.0030
Epoch 88 		Train Acc: 0.8655	Train loss: 0.0003	Test Acc: 0.9368	Test loss: 0.0001	ASR: 0.1001	ASR loss: 0.0030
Epoch 89 		Train Acc: 0.8613	Train loss: 0.0003	Test Acc: 0.9364	Test loss: 0.0001	ASR: 0.0994	ASR loss: 0.0031
Epoch 90 		Train Acc: 0.8670	Train loss: 0.0003	Test Acc: 0.9374	Test loss: 0.0001	ASR: 0.0989	ASR loss: 0.0031
Epoch 91 		Train Acc: 0.8643	Train loss: 0.0003	Test Acc: 0.9378	Test loss: 0.0001	ASR: 0.0996	ASR loss: 0.0031
Epoch 92 		Train Acc: 0.8695	Train loss: 0.0003	Test Acc: 0.9391	Test loss: 0.0001	ASR: 0.1001	ASR loss: 0.0031
Epoch 93 		Train Acc: 0.8656	Train loss: 0.0003	Test Acc: 0.9414	Test loss: 0.0001	ASR: 0.0999	ASR loss: 0.0031
Epoch 94 		Train Acc: 0.8705	Train loss: 0.0003	Test Acc: 0.9416	Test loss: 0.0001	ASR: 0.0995	ASR loss: 0.0031
Epoch 95 		Train Acc: 0.8673	Train loss: 0.0003	Test Acc: 0.9404	Test loss: 0.0001	ASR: 0.0993	ASR loss: 0.0031
Epoch 96 		Train Acc: 0.8707	Train loss: 0.0003	Test Acc: 0.9412	Test loss: 0.0001	ASR: 0.0994	ASR loss: 0.0031
Epoch 97 		Train Acc: 0.8685	Train loss: 0.0003	Test Acc: 0.9420	Test loss: 0.0001	ASR: 0.0994	ASR loss: 0.0032
Epoch 98 		Train Acc: 0.8715	Train loss: 0.0003	Test Acc: 0.9442	Test loss: 0.0001	ASR: 0.0996	ASR loss: 0.0032
Epoch 99 		Train Acc: 0.8677	Train loss: 0.0003	Test Acc: 0.9443	Test loss: 0.0001	ASR: 0.0998	ASR loss: 0.0032
Training finished on Mon Jan 26 16:03:22 2026 using 62 minutes and 40 seconds in total.
