seed: 4, epochs: 100, algorithm: FedAvg, optimizer: SGD, momentum: 0.9, weight_decay: 0.0005, num_clients: 20, batch_size: 4096, learning_rate: 0.01, local_epochs: 2, model: lenet, dataset: MNIST, distribution: non-iid, im_iid_gamma: 0.01, tail_cls_from: 4, dirichlet_alpha: 0.5, cache_partition: False, gpu_idx: [1], num_workers: 16, record_time: False, num_adv: 4, attack: BadNets, defense: FLARE, attack_params: {'attack_model': 'all2one', 'scaling_factor': 100, 'trigger_factor': [8, 2, 0], 'poisoning_ratio': 0.32, 'source_label': 2, 'target_label': 7, 'attack_strategy': 'continuous'}, defense_params: {'aux_data_num': 100, 'selected_class': 1, 'tau': 1.0, 'mmd_kernel': 'rbf', 'mmd_gamma': None}, benchmark: False, num_training_sample: 60000, num_channels: 1, num_classes: 10, mean: (0.1307,), std: (0.3081,), device: cuda:1, output: ./logs/FedAvg/MNIST_lenet/non-iid/MNIST_lenet_non-iid_alpha0.5_BadNets_FLARE_100_20_0.01_FedAvg.txt

Started on Tue Jan 27 00:15:02 2026
Generating new indices
Doing non-iid partition
dirichlet alpha: 0.5
non-iid partition finished
Data partitioned
Clients and server are initialized
Starting Training...
Epoch 0  		Train Acc: 0.0795	Train loss: 0.0012	Test Acc: 0.1033	Test loss: 0.0007	ASR: 0.0000	ASR loss: 0.0007
Epoch 1  		Train Acc: 0.0792	Train loss: 0.0012	Test Acc: 0.1037	Test loss: 0.0007	ASR: 0.0000	ASR loss: 0.0007
Epoch 2  		Train Acc: 0.0810	Train loss: 0.0012	Test Acc: 0.1048	Test loss: 0.0007	ASR: 0.0000	ASR loss: 0.0007
Epoch 3  		Train Acc: 0.0870	Train loss: 0.0012	Test Acc: 0.1079	Test loss: 0.0007	ASR: 0.0000	ASR loss: 0.0007
Epoch 4  		Train Acc: 0.1171	Train loss: 0.0012	Test Acc: 0.1190	Test loss: 0.0007	ASR: 0.0014	ASR loss: 0.0007
Epoch 5  		Train Acc: 0.1566	Train loss: 0.0012	Test Acc: 0.1974	Test loss: 0.0007	ASR: 0.1452	ASR loss: 0.0007
Epoch 6  		Train Acc: 0.2213	Train loss: 0.0012	Test Acc: 0.1554	Test loss: 0.0007	ASR: 0.7185	ASR loss: 0.0007
Epoch 7  		Train Acc: 0.2282	Train loss: 0.0012	Test Acc: 0.1161	Test loss: 0.0007	ASR: 0.9719	ASR loss: 0.0007
Epoch 8  		Train Acc: 0.2117	Train loss: 0.0012	Test Acc: 0.1058	Test loss: 0.0007	ASR: 0.9975	ASR loss: 0.0006
Epoch 9  		Train Acc: 0.2038	Train loss: 0.0012	Test Acc: 0.1033	Test loss: 0.0007	ASR: 0.9998	ASR loss: 0.0006
Epoch 10 		Train Acc: 0.2067	Train loss: 0.0012	Test Acc: 0.1030	Test loss: 0.0007	ASR: 1.0000	ASR loss: 0.0006
Epoch 11 		Train Acc: 0.2101	Train loss: 0.0012	Test Acc: 0.1028	Test loss: 0.0007	ASR: 1.0000	ASR loss: 0.0006
Epoch 12 		Train Acc: 0.2135	Train loss: 0.0011	Test Acc: 0.1028	Test loss: 0.0007	ASR: 1.0000	ASR loss: 0.0006
Epoch 13 		Train Acc: 0.2174	Train loss: 0.0011	Test Acc: 0.1033	Test loss: 0.0007	ASR: 0.9998	ASR loss: 0.0006
Epoch 14 		Train Acc: 0.2214	Train loss: 0.0011	Test Acc: 0.1047	Test loss: 0.0007	ASR: 0.9992	ASR loss: 0.0006
Epoch 15 		Train Acc: 0.2304	Train loss: 0.0011	Test Acc: 0.1112	Test loss: 0.0007	ASR: 0.9952	ASR loss: 0.0006
Epoch 16 		Train Acc: 0.2437	Train loss: 0.0011	Test Acc: 0.1206	Test loss: 0.0007	ASR: 0.9865	ASR loss: 0.0006
Epoch 17 		Train Acc: 0.2627	Train loss: 0.0011	Test Acc: 0.1397	Test loss: 0.0007	ASR: 0.9632	ASR loss: 0.0006
Epoch 18 		Train Acc: 0.2923	Train loss: 0.0011	Test Acc: 0.1627	Test loss: 0.0007	ASR: 0.9172	ASR loss: 0.0006
Epoch 19 		Train Acc: 0.3192	Train loss: 0.0011	Test Acc: 0.1900	Test loss: 0.0006	ASR: 0.8455	ASR loss: 0.0006
Epoch 20 		Train Acc: 0.3493	Train loss: 0.0010	Test Acc: 0.2302	Test loss: 0.0006	ASR: 0.7484	ASR loss: 0.0005
Epoch 21 		Train Acc: 0.3774	Train loss: 0.0010	Test Acc: 0.2728	Test loss: 0.0006	ASR: 0.6765	ASR loss: 0.0005
Epoch 22 		Train Acc: 0.3994	Train loss: 0.0009	Test Acc: 0.3430	Test loss: 0.0006	ASR: 0.5836	ASR loss: 0.0005
Epoch 23 		Train Acc: 0.4309	Train loss: 0.0009	Test Acc: 0.4359	Test loss: 0.0005	ASR: 0.4707	ASR loss: 0.0006
Epoch 24 		Train Acc: 0.4906	Train loss: 0.0008	Test Acc: 0.5479	Test loss: 0.0005	ASR: 0.3281	ASR loss: 0.0006
Epoch 25 		Train Acc: 0.5548	Train loss: 0.0007	Test Acc: 0.5759	Test loss: 0.0004	ASR: 0.2188	ASR loss: 0.0007
Epoch 26 		Train Acc: 0.5829	Train loss: 0.0007	Test Acc: 0.6505	Test loss: 0.0004	ASR: 0.2018	ASR loss: 0.0008
Epoch 27 		Train Acc: 0.6300	Train loss: 0.0006	Test Acc: 0.7016	Test loss: 0.0003	ASR: 0.1700	ASR loss: 0.0009
Epoch 28 		Train Acc: 0.6682	Train loss: 0.0006	Test Acc: 0.7086	Test loss: 0.0003	ASR: 0.1448	ASR loss: 0.0010
Epoch 29 		Train Acc: 0.6726	Train loss: 0.0006	Test Acc: 0.7409	Test loss: 0.0003	ASR: 0.1222	ASR loss: 0.0012
Epoch 30 		Train Acc: 0.6970	Train loss: 0.0005	Test Acc: 0.7208	Test loss: 0.0002	ASR: 0.1894	ASR loss: 0.0011
Epoch 31 		Train Acc: 0.6737	Train loss: 0.0006	Test Acc: 0.7523	Test loss: 0.0002	ASR: 0.1355	ASR loss: 0.0014
Epoch 32 		Train Acc: 0.6933	Train loss: 0.0006	Test Acc: 0.7716	Test loss: 0.0002	ASR: 0.1302	ASR loss: 0.0014
Epoch 33 		Train Acc: 0.7051	Train loss: 0.0005	Test Acc: 0.7793	Test loss: 0.0002	ASR: 0.1355	ASR loss: 0.0013
Epoch 34 		Train Acc: 0.7322	Train loss: 0.0004	Test Acc: 0.7904	Test loss: 0.0002	ASR: 0.1347	ASR loss: 0.0013
Epoch 35 		Train Acc: 0.7479	Train loss: 0.0004	Test Acc: 0.7994	Test loss: 0.0002	ASR: 0.1298	ASR loss: 0.0013
Epoch 36 		Train Acc: 0.7703	Train loss: 0.0004	Test Acc: 0.8065	Test loss: 0.0002	ASR: 0.1277	ASR loss: 0.0013
Epoch 37 		Train Acc: 0.7647	Train loss: 0.0004	Test Acc: 0.8111	Test loss: 0.0002	ASR: 0.1307	ASR loss: 0.0013
Epoch 38 		Train Acc: 0.7799	Train loss: 0.0003	Test Acc: 0.8151	Test loss: 0.0002	ASR: 0.1327	ASR loss: 0.0013
Epoch 39 		Train Acc: 0.7771	Train loss: 0.0003	Test Acc: 0.8227	Test loss: 0.0002	ASR: 0.1252	ASR loss: 0.0013
Epoch 40 		Train Acc: 0.7930	Train loss: 0.0003	Test Acc: 0.8318	Test loss: 0.0001	ASR: 0.1203	ASR loss: 0.0014
Epoch 41 		Train Acc: 0.7893	Train loss: 0.0003	Test Acc: 0.8405	Test loss: 0.0001	ASR: 0.1205	ASR loss: 0.0014
Epoch 42 		Train Acc: 0.8023	Train loss: 0.0003	Test Acc: 0.8446	Test loss: 0.0001	ASR: 0.1263	ASR loss: 0.0014
Epoch 43 		Train Acc: 0.7979	Train loss: 0.0003	Test Acc: 0.8492	Test loss: 0.0001	ASR: 0.1263	ASR loss: 0.0014
Epoch 44 		Train Acc: 0.8107	Train loss: 0.0003	Test Acc: 0.8548	Test loss: 0.0001	ASR: 0.1223	ASR loss: 0.0014
Epoch 45 		Train Acc: 0.8064	Train loss: 0.0003	Test Acc: 0.8607	Test loss: 0.0001	ASR: 0.1216	ASR loss: 0.0013
Epoch 46 		Train Acc: 0.8201	Train loss: 0.0003	Test Acc: 0.8648	Test loss: 0.0001	ASR: 0.1232	ASR loss: 0.0013
Epoch 47 		Train Acc: 0.8140	Train loss: 0.0003	Test Acc: 0.8701	Test loss: 0.0001	ASR: 0.1236	ASR loss: 0.0013
Epoch 48 		Train Acc: 0.8258	Train loss: 0.0003	Test Acc: 0.8776	Test loss: 0.0001	ASR: 0.1225	ASR loss: 0.0013
Epoch 49 		Train Acc: 0.8233	Train loss: 0.0003	Test Acc: 0.8803	Test loss: 0.0001	ASR: 0.1225	ASR loss: 0.0013
Epoch 50 		Train Acc: 0.8314	Train loss: 0.0003	Test Acc: 0.8837	Test loss: 0.0001	ASR: 0.1231	ASR loss: 0.0012
Epoch 51 		Train Acc: 0.8313	Train loss: 0.0003	Test Acc: 0.8859	Test loss: 0.0001	ASR: 0.1232	ASR loss: 0.0012
Epoch 52 		Train Acc: 0.8379	Train loss: 0.0003	Test Acc: 0.8871	Test loss: 0.0001	ASR: 0.1224	ASR loss: 0.0012
Epoch 53 		Train Acc: 0.8341	Train loss: 0.0003	Test Acc: 0.8893	Test loss: 0.0001	ASR: 0.1208	ASR loss: 0.0012
Epoch 54 		Train Acc: 0.8421	Train loss: 0.0003	Test Acc: 0.8920	Test loss: 0.0001	ASR: 0.1202	ASR loss: 0.0013
Epoch 55 		Train Acc: 0.8387	Train loss: 0.0003	Test Acc: 0.8933	Test loss: 0.0001	ASR: 0.1212	ASR loss: 0.0012
Epoch 56 		Train Acc: 0.8449	Train loss: 0.0002	Test Acc: 0.8960	Test loss: 0.0001	ASR: 0.1219	ASR loss: 0.0012
Epoch 57 		Train Acc: 0.8442	Train loss: 0.0002	Test Acc: 0.8995	Test loss: 0.0001	ASR: 0.1193	ASR loss: 0.0012
Epoch 58 		Train Acc: 0.8502	Train loss: 0.0002	Test Acc: 0.9023	Test loss: 0.0001	ASR: 0.1182	ASR loss: 0.0012
Epoch 59 		Train Acc: 0.8494	Train loss: 0.0002	Test Acc: 0.9040	Test loss: 0.0001	ASR: 0.1190	ASR loss: 0.0012
Epoch 60 		Train Acc: 0.8553	Train loss: 0.0002	Test Acc: 0.9052	Test loss: 0.0001	ASR: 0.1202	ASR loss: 0.0012
Epoch 61 		Train Acc: 0.8520	Train loss: 0.0002	Test Acc: 0.9068	Test loss: 0.0001	ASR: 0.1200	ASR loss: 0.0012
Epoch 62 		Train Acc: 0.8586	Train loss: 0.0002	Test Acc: 0.9096	Test loss: 0.0001	ASR: 0.1172	ASR loss: 0.0012
Epoch 63 		Train Acc: 0.8562	Train loss: 0.0002	Test Acc: 0.9111	Test loss: 0.0001	ASR: 0.1174	ASR loss: 0.0012
Epoch 64 		Train Acc: 0.8615	Train loss: 0.0002	Test Acc: 0.9117	Test loss: 0.0001	ASR: 0.1204	ASR loss: 0.0012
Epoch 65 		Train Acc: 0.8598	Train loss: 0.0002	Test Acc: 0.9130	Test loss: 0.0001	ASR: 0.1212	ASR loss: 0.0012
Epoch 66 		Train Acc: 0.8630	Train loss: 0.0002	Test Acc: 0.9135	Test loss: 0.0001	ASR: 0.1206	ASR loss: 0.0012
Epoch 67 		Train Acc: 0.8646	Train loss: 0.0002	Test Acc: 0.9148	Test loss: 0.0001	ASR: 0.1191	ASR loss: 0.0012
Epoch 68 		Train Acc: 0.8658	Train loss: 0.0002	Test Acc: 0.9175	Test loss: 0.0001	ASR: 0.1187	ASR loss: 0.0012
Epoch 69 		Train Acc: 0.8661	Train loss: 0.0002	Test Acc: 0.9187	Test loss: 0.0001	ASR: 0.1196	ASR loss: 0.0012
Epoch 70 		Train Acc: 0.8694	Train loss: 0.0002	Test Acc: 0.9203	Test loss: 0.0001	ASR: 0.1203	ASR loss: 0.0012
Epoch 71 		Train Acc: 0.8696	Train loss: 0.0002	Test Acc: 0.9211	Test loss: 0.0001	ASR: 0.1208	ASR loss: 0.0012
Epoch 72 		Train Acc: 0.8728	Train loss: 0.0002	Test Acc: 0.9227	Test loss: 0.0001	ASR: 0.1207	ASR loss: 0.0012
Epoch 73 		Train Acc: 0.8716	Train loss: 0.0002	Test Acc: 0.9246	Test loss: 0.0001	ASR: 0.1197	ASR loss: 0.0012
Epoch 74 		Train Acc: 0.8758	Train loss: 0.0002	Test Acc: 0.9252	Test loss: 0.0001	ASR: 0.1207	ASR loss: 0.0012
Epoch 75 		Train Acc: 0.8727	Train loss: 0.0002	Test Acc: 0.9251	Test loss: 0.0001	ASR: 0.1212	ASR loss: 0.0012
Epoch 76 		Train Acc: 0.8767	Train loss: 0.0002	Test Acc: 0.9272	Test loss: 0.0001	ASR: 0.1211	ASR loss: 0.0012
Epoch 77 		Train Acc: 0.8749	Train loss: 0.0002	Test Acc: 0.9290	Test loss: 0.0001	ASR: 0.1213	ASR loss: 0.0012
Epoch 78 		Train Acc: 0.8781	Train loss: 0.0002	Test Acc: 0.9293	Test loss: 0.0001	ASR: 0.1225	ASR loss: 0.0012
Epoch 79 		Train Acc: 0.8753	Train loss: 0.0002	Test Acc: 0.9308	Test loss: 0.0001	ASR: 0.1225	ASR loss: 0.0011
Epoch 80 		Train Acc: 0.8784	Train loss: 0.0002	Test Acc: 0.9323	Test loss: 0.0001	ASR: 0.1228	ASR loss: 0.0011
Epoch 81 		Train Acc: 0.8784	Train loss: 0.0002	Test Acc: 0.9335	Test loss: 0.0001	ASR: 0.1229	ASR loss: 0.0011
Epoch 82 		Train Acc: 0.8812	Train loss: 0.0002	Test Acc: 0.9336	Test loss: 0.0001	ASR: 0.1235	ASR loss: 0.0011
Epoch 83 		Train Acc: 0.8803	Train loss: 0.0002	Test Acc: 0.9351	Test loss: 0.0001	ASR: 0.1237	ASR loss: 0.0011
Epoch 84 		Train Acc: 0.8840	Train loss: 0.0002	Test Acc: 0.9355	Test loss: 0.0001	ASR: 0.1237	ASR loss: 0.0011
Epoch 85 		Train Acc: 0.8822	Train loss: 0.0002	Test Acc: 0.9373	Test loss: 0.0001	ASR: 0.1239	ASR loss: 0.0011
Epoch 86 		Train Acc: 0.8855	Train loss: 0.0002	Test Acc: 0.9380	Test loss: 0.0001	ASR: 0.1245	ASR loss: 0.0011
Epoch 87 		Train Acc: 0.8847	Train loss: 0.0002	Test Acc: 0.9388	Test loss: 0.0001	ASR: 0.1255	ASR loss: 0.0011
Epoch 88 		Train Acc: 0.8873	Train loss: 0.0002	Test Acc: 0.9389	Test loss: 0.0001	ASR: 0.1278	ASR loss: 0.0011
Epoch 89 		Train Acc: 0.8855	Train loss: 0.0002	Test Acc: 0.9399	Test loss: 0.0001	ASR: 0.1304	ASR loss: 0.0011
Epoch 90 		Train Acc: 0.8893	Train loss: 0.0002	Test Acc: 0.9401	Test loss: 0.0001	ASR: 0.1293	ASR loss: 0.0011
Epoch 91 		Train Acc: 0.8889	Train loss: 0.0002	Test Acc: 0.9413	Test loss: 0.0001	ASR: 0.1289	ASR loss: 0.0011
Epoch 92 		Train Acc: 0.8905	Train loss: 0.0002	Test Acc: 0.9427	Test loss: 0.0001	ASR: 0.1294	ASR loss: 0.0011
Epoch 93 		Train Acc: 0.8882	Train loss: 0.0002	Test Acc: 0.9438	Test loss: 0.0001	ASR: 0.1307	ASR loss: 0.0011
Epoch 94 		Train Acc: 0.8908	Train loss: 0.0002	Test Acc: 0.9442	Test loss: 0.0001	ASR: 0.1332	ASR loss: 0.0011
Epoch 95 		Train Acc: 0.8904	Train loss: 0.0002	Test Acc: 0.9454	Test loss: 0.0001	ASR: 0.1360	ASR loss: 0.0011
Epoch 96 		Train Acc: 0.8938	Train loss: 0.0002	Test Acc: 0.9457	Test loss: 0.0001	ASR: 0.1360	ASR loss: 0.0010
Epoch 97 		Train Acc: 0.8943	Train loss: 0.0002	Test Acc: 0.9469	Test loss: 0.0001	ASR: 0.1386	ASR loss: 0.0010
Epoch 98 		Train Acc: 0.8947	Train loss: 0.0002	Test Acc: 0.9477	Test loss: 0.0001	ASR: 0.1404	ASR loss: 0.0010
Epoch 99 		Train Acc: 0.8969	Train loss: 0.0002	Test Acc: 0.9485	Test loss: 0.0001	ASR: 0.1427	ASR loss: 0.0010
Training finished on Tue Jan 27 01:34:11 2026 using 79 minutes and 8 seconds in total.
