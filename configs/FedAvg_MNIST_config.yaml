# FedAvg + MNIST — Quick wins: local_epochs 2, num_clients 20, epochs 150, FLARE aux_data_num 100
# Use with: --config này, chỉ override: -dtb non-iid -dirichlet_alpha <float> (nếu non-iid)
seed: 4
epochs: 150
algorithm: FedAvg
optimizer: SGD
momentum: 0.9
weight_decay: 5.0e-4
num_clients: 20
batch_size: 4096
learning_rate: 0.01
local_epochs: 2
model: lenet
dataset: MNIST
distribution: iid
im_iid_gamma: 0.01
tail_cls_from: 4
dirichlet_alpha: 0.5
cache_partition: False
gpu_idx: [1]
num_workers: 16
record_time: False

num_adv: 0.2
attack: DBA
defense: FLARE
# Note: EdgeCase uses ARDIS dataset with source_label=7, target_label must be != 7

attacks:
  - attack: NoAttack
  - attack: DBA
    attack_params:
      attack_model: "all2one"
      scaling_factor: 100
      trigger_factor: [8, 2, 0]
      poisoning_ratio: 0.32
      source_label: 2
      target_label: 7
      attack_strategy: "continuous"
  - attack: BadNets
    attack_params:
      attack_model: "all2one"
      poisoning_ratio: 0.32
      source_label: 2
      target_label: 7
      trigger_position: "cc"
      trigger_size: 3
  - attack: EdgeCase
    attack_params:
      poisoning_ratio: 0.8
      epsilon: 0.25
      PGD_attack: True
      projection_type: "l_2"
      l2_proj_frequency: 1
      scaling_attack: True
      scaling_factor: 50
      target_label: 1
  - attack: ModelReplacement
    attack_params:
      poisoning_ratio: 0.5
      source_label: 2
      target_label: 7

defenses:
  - defense: Mean
  - defense: FLARE
    defense_params:
      aux_data_num: 100
      selected_class: 1
      tau: 1.0
      mmd_kernel: "rbf"
      mmd_gamma: null
  - defense: CPLRFL
    defense_params:
      samples_per_class: 50
      similarity_metric: "mmd"
      tau: 1.0
      mmd_kernel: "rbf"
      mmd_gamma: null
  - defense: FLAME
    defense_params:
      gamma: 1.2e-5
